{"version":3,"file":"persistable.7ed992b0.js","sources":["../../node_modules/@arcgis/core/portal/support/resourceExtension.js","../../node_modules/@arcgis/core/core/accessorSupport/decorators/persistable.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nimport{getPathExtension as i}from\"../../core/urlUtils.js\";function p(i){return o[n(i)]||e}function n(i){return i instanceof Blob?i.type:t(i.url)}function t(p){const n=i(p);return g[n]||a}const o={},a=\"text/plain\",e=o[a],g={png:\"image/png\",jpeg:\"image/jpeg\",jpg:\"image/jpg\",bmp:\"image/bmp\",gif:\"image/gif\",json:\"application/json\",txt:\"text/plain\",xml:\"application/xml\",svg:\"image/svg+xml\",zip:\"application/zip\",pbf:\"application/vnd.mapbox-vector-tile\",gz:\"application/gzip\"};for(const l in g)o[g[l]]=l;export{p as getResourceContentExtension};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nimport{isSome as t,isNone as r,get as e}from\"../../maybe.js\";import{isMultiOriginJSONMixin as o}from\"../../multiOriginJSONSupportUtils.js\";import{isAbsolute as i,isBlobProtocol as n,join as s,getPathExtension as u}from\"../../urlUtils.js\";import{generateUUID as p}from\"../../uuid.js\";import{getOwnPropertyMetadata as a}from\"../metadata.js\";import{nameToId as c}from\"../PropertyOrigin.js\";import{propertyJSONMeta as l}from\"./property.js\";import{getResourceContentExtension as f}from\"../../../portal/support/resourceExtension.js\";import{r as m,t as y,i as h,p as d}from\"../../../chunks/persistableUrlUtils.js\";function g(r){const e=t(r)&&r.origins?r.origins:[void 0];return(t,o)=>{const i=w(r,t,o);for(const r of e){const e=l(t,r,o);for(const t in i)e[t]=i[t]}}}function w(r,e,o){if(t(r)&&\"resource\"===r.type)return v(r,e,o);switch(t(r)&&r.type?r.type:\"other\"){case\"other\":return{read:!0,write:!0};case\"url\":{const{read:t,write:r}=d;return{read:t,write:r}}}}function v(e,s,u){const p=a(s,u);return{type:String,read:(t,r,e)=>{const o=m(t,r,e);return p.type===String?o:\"function\"==typeof p.type?new p.type({url:o}):void 0},write:{writer(s,a,l,f){if(!f||!f.resources)return\"string\"==typeof s?void(a[l]=y(s,f)):void(a[l]=s.write({},f));const m=P(s),d=m?y(m,{...f,verifyItemRelativeUrls:f&&f.verifyItemRelativeUrls?{writtenUrls:f.verifyItemRelativeUrls.writtenUrls,rootPath:null}:null},1):null,g=p.type!==String&&(!o(this)||f&&f.origin&&this.originIdOf(u)>c(f.origin));f&&f.portalItem&&t(d)&&!i(d)?g?j(this,u,s,d,a,l,f,e):I(d,a,l,f):f&&f.portalItem&&(r(d)||t(h(d))||n(d)||g)?U(this,u,s,d,a,l,f,e):a[l]=d}}}}function U(t,r,o,i,u,a,c,l){const m=p(),y=S(o,i,c),h=s(e(l,\"prefix\"),m),d=`${h}.${f(y)}`,g=c.portalItem.resourceFromPath(d);n(i)&&c.resources.pendingOperations.push(b(i).then((t=>{g.path=`${h}.${f(t)}`,u[a]=g.itemRelativeUrl})).catch((()=>{}))),O(t,r,g,y,c.resources.toAdd),u[a]=g.itemRelativeUrl}function j(t,r,e,o,i,n,s,p){const a=s.portalItem.resourceFromPath(o),c=S(e,o,s);f(c)===u(a.path)?(O(t,r,a,c,s.resources.toUpdate),i[n]=o):U(t,r,e,o,i,n,s,p)}function I(t,r,e,o){o.resources.toKeep.push({resource:o.portalItem.resourceFromPath(t)}),r[e]=t}function O(t,r,e,o,i){i.push({resource:e,content:o,finish:e=>{R(t,r,e)}})}function S(t,r,e){return\"string\"==typeof t?{url:r}:new Blob([JSON.stringify(t.toJSON(e))],{type:\"application/json\"})}async function b(t){const r=(await import(\"../../../request.js\")).default,{data:e}=await r(t,{responseType:\"blob\"});return e}function P(t){return r(t)?null:\"string\"==typeof t?t:t.url}function R(t,r,e){\"string\"==typeof t[r]?t[r]=e.url:t[r].url=e.url}export{g as persistable};\n"],"names":["i","g","r","t","l","d","s","a","y","o","c","h","n","p","e","f","u"],"mappings":"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"}