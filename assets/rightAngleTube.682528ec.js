import{reactive as H,ref as J,onMounted as L,openBlock as O,createElementBlock as R,isRef as T}from"vue";import{B as W}from"./base3D.6463c8aa.js";import{t as z}from"./threeUniversal.9ce15fef.js";import{aH as j,c as S,M as K,D as Q,aI as Y,aJ as Z,h as n,ai as I,B as $,k as E}from"./three.module.3b505d30.js";import"./OrbitControls.5e199169.js";import"./stats.module.0fc722e3.js";const se={setup(ee){let d=H({base3d:{}}),m=J(null),v=new j;v.absarc(0,0,5,0,Math.PI*2);var A=new j;A.absarc(1,1,.5,Math.PI,Math.PI*.5);var V=[new n(0,0),new n(1,1),new n(2,1),new n(2,0),new n(1,-1)];let C=[new n(-40,50),new n(0,50),new n(50,50),new n(50,0)];L(()=>{d.base3d=new W(m.value),z.addFloor(d.base3d.scene),D()});function D(){_()}function _(){let s=B(v,C,!1,!0);s.rotateX(-Math.PI*.5);let e=new S(s,new K({color:"aqua",opacity:.4,depthWrite:!1,depthTest:!1,transparent:!0,side:Q}));e.position.set(-7,1,-5),d.base3d.scene.add(e);var l=B(A,V,!1,!0);new S(l,new Y({color:"red",wireframe:!1}))}function B(s,e,l,a){l=l!==void 0?l:!0,a=a!==void 0?a:!1,a=l===!0?!1:a;let o=new Z(s),U=k(o);o.rotateX(Math.PI*.5);let i=o.attributes.position,F=a===!1?2:0,y=new Float32Array(i.count*(e.length+F)*3),G=[];for(let t=0;t<e.length;t++){let r=new n().subVectors(e[t-1<0?e.length-1:t-1],e[t]),h=new n().subVectors(e[t+1===e.length?0:t+1],e[t]);console.log(h.angle(),r.angle());let c=(h.angle()-r.angle())*.5,M=h.angle()+Math.PI*.5;l||((t==0||t==e.length-1)&&(c=Math.PI*.5),t==e.length-1&&(M=r.angle()-Math.PI*.5));let w=Math.tan(c-Math.PI*.5),P=new I().set(1,0,0,0,-w,1,0,0,0,0,1,0,0,0,0,1),f=M,X=new I().set(Math.cos(f),-Math.sin(f),0,0,Math.sin(f),Math.cos(f),0,0,0,0,1,0,0,0,0,1),q=new I().set(1,0,0,e[t].x,0,1,0,e[t].y,0,0,1,0,0,0,0,1),p=i.clone();p.applyMatrix4(P),p.applyMatrix4(X),p.applyMatrix4(q),y.set(p.array,p.count*t*3),a===!1&&(t===0||t===e.length-1)&&G.push(p)}G.forEach((t,r)=>{y.set(t.array,t.count*(e.length+r)*3)});let g=new $;g.setAttribute("position",new E(y,3));let u=[],N=l===!1?e.length-1:e.length;for(let t=0;t<N;t++)for(let r=0;r<i.count;r++){let h=t,b=t+1===e.length?0:t+1,x=r,c=r+1===i.count?0:r+1,M=c+i.count*h,w=x+i.count*h,P=x+i.count*b,f=c+i.count*b;u.push(M,w,f),u.push(w,P,f)}return a===!1&&(U.index.array.forEach(t=>{u.push(t+i.count*e.length)}),o.index.array.forEach(t=>{u.push(t+i.count*(e.length+1))})),g.setIndex(u),g.computeVertexNormals(),g}function k(s){let e=s.clone();for(let a=0;a<e.attributes.position.count;a++)e.attributes.position.array[a*3]*=-1;e.attributes.position.needsUpdate=!0;let l=e.index.array;for(let a=0;a<l.length;a+=3){let o=l[a+1];l[a+2],l[a+1]=l[a+2],l[a+2]=o}return e.computeVertexNormals(),e}return(s,e)=>(O(),R("div",{id:"sceneContainer",ref:(l,a)=>{a.sceneContainer=l,T(m)?m.value=l:m=l}},null,512))}};export{se as default};
//# sourceMappingURL=rightAngleTube.682528ec.js.map
