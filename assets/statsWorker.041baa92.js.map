{"version":3,"file":"statsWorker.041baa92.js","sources":["../../node_modules/@arcgis/core/smartMapping/statistics/support/utils.js","../../node_modules/@arcgis/core/smartMapping/statistics/support/statsWorker.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nimport e from\"../../../core/Error.js\";import{isSome as t}from\"../../../core/maybe.js\";import n from\"../../../geometry/SpatialReference.js\";import{isNumericField as i,numericTypes as o}from\"../../../layers/support/fieldUtils.js\";import{getNormalizedValue as r}from\"../../../statistics/utils.js\";import{loadArcade as l}from\"../../../support/arcadeOnDemand.js\";let s=null;async function a(e,t){if(!t)return[];const i=e.field,o=e.valueExpression,a=e.normalizationType,f=e.normalizationField,c=e.normalizationTotal,u=[],d=e.viewInfoParams;let p=null,m=null;if(o){if(!s){const{arcadeUtils:e}=await l();s=e}p=s.createFunction(o),m=d&&s.getViewInfo({viewingMode:d.viewingMode,scale:d.scale,spatialReference:new n(d.spatialReference)})}return t.forEach((e=>{const t=e.attributes;let n;if(o){const t=s.createExecContext(e,m);n=s.executeFunction(p,t)}else t&&(n=t[i]);if(a&&isFinite(n)){const e=t&&parseFloat(t[f]);n=r(n,a,e,c)}u.push(n)})),u}function f(e){const t=e.field,n=e.normalizationType,i=e.normalizationField;let o;return\"field\"===n?o=\"(NOT \"+i+\" = 0)\":\"log\"!==n&&\"natural-log\"!==n&&\"square-root\"!==n||(o=`(${t} > 0)`),o}function c(t,n){return new e(t,n)}function u(e,t,n){const i=null!=t?e+\" >= \"+t:\"\",o=null!=n?e+\" <= \"+n:\"\";let r=\"\";return r=i&&o?m(i,o):i||o,r?\"(\"+r+\")\":\"\"}function d(e,t,n,i){let o=null;return t?t.name!==e.objectIdField&&-1!==i.indexOf(t.type)||(o=c(n,\"'field' should be one of these types: \"+i.join(\",\"))):o=c(n,\"'field' is not defined in the layer schema\"),o}function p(e,t,n){let r;return t?t.name!==e.objectIdField&&i(t)||(r=c(n,\"'field' should be one of these numeric types: \"+o.join(\",\"))):r=c(n,\"'field' is not defined in the layer schema\"),r}function m(e,n){let i=t(e)?e:\"\";return t(n)&&n&&(i=i?\"(\"+i+\") AND (\"+n+\")\":n),i}function y(e,t,n){const i=h({layer:e,fields:t});if(i.length)return c(n,\"Unknown fields: \"+i.join(\", \")+\". You can only use fields defined in the layer schema\");const o=g({layer:e,fields:t});return o.length?c(n,\"Unsupported fields: \"+o.join(\", \")+\". You can only use fields that can be fetched i.e. AdapterFieldUsageInfo.supportsStatistics must be true\"):void 0}function h(e){const t=e.layer;return e.fields.filter((e=>!t.getField(e)))}function g(e){const t=e.layer;return e.fields.filter((e=>{const n=t.getFieldUsageInfo(e);return!n||!n.supportsStatistics}))}export{c as createError,a as getDataValues,u as getRangeExpr,f as getSQLFilterForNormalization,m as mergeWhereClauses,y as verifyBasicFieldValidity,d as verifyFieldType,p as verifyNumericField};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nimport{getDataValues as a}from\"./utils.js\";import{isNullCountSupported as i,calculateStringStatistics as n,calculateStatistics as e,processSummaryStatisticsResult as o,calculateUniqueValuesCount as l,createUVResult as t,calculateClassBreaks as r,resolveCBResult as s,calculateHistogram as m}from\"../../../statistics/utils.js\";async function u(l){const{attribute:t,features:r}=l,{normalizationType:s,normalizationField:m,minValue:u,maxValue:d,fieldType:f}=t,p=await a({field:t.field,valueExpression:t.valueExpression,normalizationType:s,normalizationField:m,normalizationTotal:t.normalizationTotal,viewInfoParams:t.viewInfoParams},r),v=i({normalizationType:s,normalizationField:m,minValue:u,maxValue:d}),z={value:.5,fieldType:f},c=\"esriFieldTypeString\"===f?n({values:p,supportsNullCount:v,percentileParams:z}):e({values:p,minValue:u,maxValue:d,useSampleStdDev:!s,supportsNullCount:v,percentileParams:z});return o(c,\"esriFieldTypeDate\"===f)}async function d(i){const{attribute:n,features:e}=i,o=await a({field:n.field,valueExpression:n.valueExpression,viewInfoParams:n.viewInfoParams},e),r=l(o);return t(r,n.domain,n.returnAllCodedValues)}async function f(i){const{attribute:n,features:e}=i,{field:o,normalizationType:l,normalizationField:t,normalizationTotal:m,classificationMethod:u}=n,d=await a({field:o,valueExpression:n.valueExpression,normalizationType:l,normalizationField:t,normalizationTotal:m,viewInfoParams:n.viewInfoParams},e),f=r(d,{field:o,normalizationType:l,normalizationField:t,normalizationTotal:m,classificationMethod:u,standardDeviationInterval:n.standardDeviationInterval,numClasses:n.numClasses,minValue:n.minValue,maxValue:n.maxValue});return s(f,u)}async function p(i){const{attribute:n,features:e}=i,{field:o,normalizationType:l,normalizationField:t,normalizationTotal:r,classificationMethod:s}=n,u=await a({field:o,valueExpression:n.valueExpression,normalizationType:l,normalizationField:t,normalizationTotal:r,viewInfoParams:n.viewInfoParams},e);return m(u,{field:o,normalizationType:l,normalizationField:t,normalizationTotal:r,classificationMethod:s,standardDeviationInterval:n.standardDeviationInterval,numBins:n.numBins,minValue:n.minValue,maxValue:n.maxValue})}export{f as classBreaks,p as histogram,u as summaryStatistics,d as uniqueValues};\n"],"names":["l","n","r","m","i","c","e","o","t","s"],"mappings":"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"}