{"version":3,"file":"layersCreator.9c43867e.js","sources":["../../node_modules/@arcgis/core/portal/support/featureCollectionUtils.js","../../node_modules/@arcgis/core/layers/support/layersCreator.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nimport e from\"../PortalItem.js\";import{hasTypeKeyword as t}from\"./portalItemUtils.js\";function r(e,t){return n(e,t,\"notes\",\"Map Notes\")}function o(e,t){return n(e,t,\"route\",\"Route Layer\")}async function n(r,o,n,i){if(!r.layerType||\"ArcGISFeatureLayer\"!==r.layerType)return!1;if(r.url)return!1;if(r.featureCollectionType&&r.featureCollectionType===n)return!0;if(r.itemId){const n=new e({id:r.itemId,portal:o});return await n.load(),\"Feature Collection\"===n.type&&t(n,i)}return!1}export{r as isMapNotesLayer,o as isRouteLayer};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nimport e from\"../../core/Collection.js\";import\"../../core/has.js\";import{eachAlways as r}from\"../../core/promiseUtils.js\";import{layerLookupMap as a}from\"./lazyLayerLoader.js\";import y from\"../../portal/PortalItem.js\";import{isMapNotesLayer as t,isRouteLayer as i}from\"../../portal/support/featureCollectionUtils.js\";import{selectLayerClassPath as L}from\"../../portal/support/portalLayers.js\";import{loadStyleRenderer as o}from\"../../renderers/support/styleUtils.js\";async function n(e,a,y){if(!a)return;const t=[];for(const r of a){const e=d(r,y);\"GroupLayer\"===r.layerType?t.push(G(e,r,y)):t.push(e)}const i=await r(t);for(const r of i)!r.value||y.filter&&!y.filter(r.value)||e.add(r.value)}const l={ArcGISFeatureLayer:\"FeatureLayer\",ArcGISImageServiceLayer:\"ImageryLayer\",ArcGISMapServiceLayer:\"MapImageLayer\",PointCloudLayer:\"PointCloudLayer\",ArcGISSceneServiceLayer:\"SceneLayer\",IntegratedMeshLayer:\"IntegratedMeshLayer\",OGCFeatureLayer:\"OGCFeatureLayer\",BuildingSceneLayer:\"BuildingSceneLayer\",ArcGISTiledElevationServiceLayer:\"ElevationLayer\",ArcGISTiledImageServiceLayer:\"ImageryTileLayer\",ArcGISTiledMapServiceLayer:\"TileLayer\",GroupLayer:\"GroupLayer\",GeoJSON:\"GeoJSONLayer\",WebTiledLayer:\"WebTileLayer\",CSV:\"CSVLayer\",VectorTileLayer:\"VectorTileLayer\",WFS:\"WFSLayer\",WMS:\"WMSLayer\",DefaultTileLayer:\"TileLayer\",KML:\"KMLLayer\",RasterDataLayer:\"UnsupportedLayer\",Voxel:\"UnsupportedLayer\"},c={ArcGISTiledElevationServiceLayer:\"ElevationLayer\",DefaultTileLayer:\"ElevationLayer\",RasterDataElevationLayer:\"UnsupportedLayer\"},s={ArcGISTiledMapServiceLayer:\"TileLayer\",ArcGISTiledImageServiceLayer:\"ImageryTileLayer\",OpenStreetMap:\"OpenStreetMapLayer\",WebTiledLayer:\"WebTileLayer\",VectorTileLayer:\"VectorTileLayer\",ArcGISImageServiceLayer:\"UnsupportedLayer\",WMS:\"UnsupportedLayer\",ArcGISMapServiceLayer:\"UnsupportedLayer\",DefaultTileLayer:\"TileLayer\"},p={ArcGISFeatureLayer:\"FeatureLayer\",ArcGISImageServiceLayer:\"ImageryLayer\",ArcGISImageServiceVectorLayer:\"ImageryLayer\",ArcGISMapServiceLayer:\"MapImageLayer\",ArcGISStreamLayer:\"StreamLayer\",ArcGISTiledImageServiceLayer:\"ImageryTileLayer\",ArcGISTiledMapServiceLayer:\"TileLayer\",BingMapsAerial:\"BingMapsLayer\",BingMapsRoad:\"BingMapsLayer\",BingMapsHybrid:\"BingMapsLayer\",CSV:\"CSVLayer\",DefaultTileLayer:\"TileLayer\",GeoRSS:\"GeoRSSLayer\",GeoJSON:\"GeoJSONLayer\",GroupLayer:\"GroupLayer\",KML:\"KMLLayer\",OGCFeatureLayer:\"OGCFeatureLayer\",SubtypeGroupLayer:\"UnsupportedLayer\",VectorTileLayer:\"VectorTileLayer\",WFS:\"WFSLayer\",WMS:\"WMSLayer\",WebTiledLayer:\"WebTileLayer\"},u={ArcGISFeatureLayer:\"FeatureLayer\"},S={ArcGISImageServiceLayer:\"ImageryLayer\",ArcGISImageServiceVectorLayer:\"ImageryLayer\",ArcGISMapServiceLayer:\"MapImageLayer\",ArcGISTiledImageServiceLayer:\"ImageryTileLayer\",ArcGISTiledMapServiceLayer:\"TileLayer\",OpenStreetMap:\"OpenStreetMapLayer\",VectorTileLayer:\"VectorTileLayer\",WebTiledLayer:\"WebTileLayer\",BingMapsAerial:\"BingMapsLayer\",BingMapsRoad:\"BingMapsLayer\",BingMapsHybrid:\"BingMapsLayer\",WMS:\"WMSLayer\",DefaultTileLayer:\"TileLayer\"};async function d(e,r){return I(await T(e,r),e,r)}async function I(e,r,a){const y=new e;return y.read(r,a.context),\"group\"===y.type&&m(r)&&await M(y,r,a.context),await o(y,a.context),y}async function T(e,r){const o=r.context,n=g(o);let l=e.layerType||e.type;!l&&r&&r.defaultLayerType&&(l=r.defaultLayerType);const c=n[l];let s=c?a[c]:a.UnknownLayer;const p=o&&o.portal;if(f(e)){if(e.itemId){const r=new y({id:e.itemId,portal:p});await r.load();const t=(await L(r)).className||\"UnknownLayer\";s=a[t]}}else\"ArcGISFeatureLayer\"===l?await t(e,p)?s=a.MapNotesLayer:await i(e,p)?s=a.RouteLayer:m(e)&&(s=a.GroupLayer):e.wmtsInfo&&e.wmtsInfo.url&&e.wmtsInfo.layerIdentifier?s=a.WMTSLayer:\"WFS\"===l&&\"2.0.0\"!==e.wfsInfo.version&&(s=a.UnsupportedLayer);return s()}function m(e){if(\"ArcGISFeatureLayer\"!==e.layerType||f(e))return!1;const r=e.featureCollection;return!!(r&&r.layers&&r.layers.length>1)}function f(e){return\"Feature Collection\"===e.type}function g(e){let r;if(\"web-scene\"===e.origin)switch(e.layerContainerType){case\"basemap\":r=s;break;case\"ground\":r=c;break;default:r=l}else switch(e.layerContainerType){case\"basemap\":r=S;break;case\"tables\":r=u;break;default:r=p}return r}async function G(r,a,y){const t=new e,i=n(t,Array.isArray(a.layers)?a.layers:[],y),L=await r;if(await i,\"group\"===L.type)return L.layers.addMany(t),L}async function M(e,r,y){const t=a.FeatureLayer,i=await t(),L=r.featureCollection,o=L.showLegend,n=L.layers.map(((a,t)=>{var L,n;const l=new i;l.read(a,y);const c={...y,ignoreDefaults:!0};return l.read({id:`${e.id}-sublayer-${t}`,visibility:null==(L=null==(n=r.visibleLayers)?void 0:n.includes(t))||L},c),null!=o&&l.read({showLegend:o},c),l}));e.layers.addMany(n)}export{n as populateOperationalLayers};\n"],"names":["n","e","r","o","y","L","t","i"],"mappings":"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"}