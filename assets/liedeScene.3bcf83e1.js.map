{"version":3,"file":"liedeScene.3bcf83e1.js","sources":["../../node_modules/tween/tween.js","../../src/components/liedeScene.vue"],"sourcesContent":["/**\n * @author sole / http://soledadpenades.com\n * @author mrdoob / http://mrdoob.com\n * @author Robert Eisele / http://www.xarg.org\n * @author Philippe / http://philippe.elsass.me\n * @author Robert Penner / http://www.robertpenner.com/easing_terms_of_use.html\n * @author Paul Lewis / http://www.aerotwist.com/\n * @author lechecacharro\n * @author Josh Faul / http://jocafa.com/\n * @author egraether / http://egraether.com/\n */\n\nif ( Date.now === undefined ) {\n\n  Date.now = function () {\n\n    return new Date().valueOf();\n\n  }\n\n}\n\nvar TWEEN = TWEEN || ( function () {\n\n  var _tweens = [];\n\n  return {\n\n    REVISION: '8',\n\n    getAll: function () {\n\n      return _tweens;\n\n    },\n\n    removeAll: function () {\n\n      _tweens = [];\n\n    },\n\n    add: function ( tween ) {\n\n      _tweens.push( tween );\n\n    },\n\n    remove: function ( tween ) {\n\n      var i = _tweens.indexOf( tween );\n\n      if ( i !== -1 ) {\n\n        _tweens.splice( i, 1 );\n\n      }\n\n    },\n\n    update: function ( time ) {\n\n      if ( _tweens.length === 0 ) return false;\n\n      var i = 0, numTweens = _tweens.length;\n\n      time = time !== undefined ? time : Date.now();\n\n      while ( i < numTweens ) {\n\n        if ( _tweens[ i ].update( time ) ) {\n\n          i ++;\n\n        } else {\n\n          _tweens.splice( i, 1 );\n\n          numTweens --;\n\n        }\n\n      }\n\n      return true;\n\n    }\n\n  };\n\n} )();\n\nTWEEN.Tween = function ( object ) {\n\n  var _object = object;\n  var _valuesStart = {};\n  var _valuesEnd = {};\n  var _duration = 1000;\n  var _delayTime = 0;\n  var _startTime = null;\n  var _easingFunction = TWEEN.Easing.Linear.None;\n  var _interpolationFunction = TWEEN.Interpolation.Linear;\n  var _chainedTweens = [];\n  var _onStartCallback = null;\n  var _onStartCallbackFired = false;\n  var _onUpdateCallback = null;\n  var _onCompleteCallback = null;\n\n  this.to = function ( properties, duration ) {\n\n    if ( duration !== undefined ) {\n\n      _duration = duration;\n\n    }\n\n    _valuesEnd = properties;\n\n    return this;\n\n  };\n\n  this.start = function ( time ) {\n\n    TWEEN.add( this );\n\n    _onStartCallbackFired = false;\n\n    _startTime = time !== undefined ? time : Date.now();\n    _startTime += _delayTime;\n\n    for ( var property in _valuesEnd ) {\n\n      // This prevents the interpolation of null values or of non-existing properties\n      if( _object[ property ] === null || !(property in _object) ) {\n\n        continue;\n\n      }\n\n      // check if an Array was provided as property value\n      if ( _valuesEnd[ property ] instanceof Array ) {\n\n        if ( _valuesEnd[ property ].length === 0 ) {\n\n          continue;\n\n        }\n\n        // create a local copy of the Array with the start value at the front\n        _valuesEnd[ property ] = [ _object[ property ] ].concat( _valuesEnd[ property ] );\n\n      }\n\n      _valuesStart[ property ] = _object[ property ];\n\n    }\n\n    return this;\n\n  };\n\n  this.stop = function () {\n\n    TWEEN.remove( this );\n    return this;\n\n  };\n\n  this.delay = function ( amount ) {\n\n    _delayTime = amount;\n    return this;\n\n  };\n\n  this.easing = function ( easing ) {\n\n    _easingFunction = easing;\n    return this;\n\n  };\n\n  this.interpolation = function ( interpolation ) {\n\n    _interpolationFunction = interpolation;\n    return this;\n\n  };\n\n  this.chain = function () {\n\n    _chainedTweens = arguments;\n    return this;\n\n  };\n\n  this.onStart = function ( callback ) {\n\n    _onStartCallback = callback;\n    return this;\n\n  };\n\n  this.onUpdate = function ( callback ) {\n\n    _onUpdateCallback = callback;\n    return this;\n\n  };\n\n  this.onComplete = function ( callback ) {\n\n    _onCompleteCallback = callback;\n    return this;\n\n  };\n\n  this.update = function ( time ) {\n\n    if ( time < _startTime ) {\n\n      return true;\n\n    }\n\n    if ( _onStartCallbackFired === false ) {\n\n      if ( _onStartCallback !== null ) {\n\n        _onStartCallback.call( _object );\n\n      }\n\n      _onStartCallbackFired = true;\n\n    }\n\n    var elapsed = ( time - _startTime ) / _duration;\n    elapsed = elapsed > 1 ? 1 : elapsed;\n\n    var value = _easingFunction( elapsed );\n\n    for ( var property in _valuesStart ) {\n\n      var start = _valuesStart[ property ];\n      var end = _valuesEnd[ property ];\n\n      if ( end instanceof Array ) {\n\n        _object[ property ] = _interpolationFunction( end, value );\n\n      } else {\n\n        _object[ property ] = start + ( end - start ) * value;\n\n      }\n\n    }\n\n    if ( _onUpdateCallback !== null ) {\n\n      _onUpdateCallback.call( _object, value );\n\n    }\n\n    if ( elapsed == 1 ) {\n\n      if ( _onCompleteCallback !== null ) {\n\n        _onCompleteCallback.call( _object );\n\n      }\n\n      for ( var i = 0, numChainedTweens = _chainedTweens.length; i < numChainedTweens; i ++ ) {\n\n        _chainedTweens[ i ].start( time );\n\n      }\n\n      return false;\n\n    }\n\n    return true;\n\n  };\n\n};\n\nTWEEN.Easing = {\n\n  Linear: {\n\n    None: function ( k ) {\n\n      return k;\n\n    }\n\n  },\n\n  Quadratic: {\n\n    In: function ( k ) {\n\n      return k * k;\n\n    },\n\n    Out: function ( k ) {\n\n      return k * ( 2 - k );\n\n    },\n\n    InOut: function ( k ) {\n\n      if ( ( k *= 2 ) < 1 ) return 0.5 * k * k;\n      return - 0.5 * ( --k * ( k - 2 ) - 1 );\n\n    }\n\n  },\n\n  Cubic: {\n\n    In: function ( k ) {\n\n      return k * k * k;\n\n    },\n\n    Out: function ( k ) {\n\n      return --k * k * k + 1;\n\n    },\n\n    InOut: function ( k ) {\n\n      if ( ( k *= 2 ) < 1 ) return 0.5 * k * k * k;\n      return 0.5 * ( ( k -= 2 ) * k * k + 2 );\n\n    }\n\n  },\n\n  Quartic: {\n\n    In: function ( k ) {\n\n      return k * k * k * k;\n\n    },\n\n    Out: function ( k ) {\n\n      return 1 - ( --k * k * k * k );\n\n    },\n\n    InOut: function ( k ) {\n\n      if ( ( k *= 2 ) < 1) return 0.5 * k * k * k * k;\n      return - 0.5 * ( ( k -= 2 ) * k * k * k - 2 );\n\n    }\n\n  },\n\n  Quintic: {\n\n    In: function ( k ) {\n\n      return k * k * k * k * k;\n\n    },\n\n    Out: function ( k ) {\n\n      return --k * k * k * k * k + 1;\n\n    },\n\n    InOut: function ( k ) {\n\n      if ( ( k *= 2 ) < 1 ) return 0.5 * k * k * k * k * k;\n      return 0.5 * ( ( k -= 2 ) * k * k * k * k + 2 );\n\n    }\n\n  },\n\n  Sinusoidal: {\n\n    In: function ( k ) {\n\n      return 1 - Math.cos( k * Math.PI / 2 );\n\n    },\n\n    Out: function ( k ) {\n\n      return Math.sin( k * Math.PI / 2 );\n\n    },\n\n    InOut: function ( k ) {\n\n      return 0.5 * ( 1 - Math.cos( Math.PI * k ) );\n\n    }\n\n  },\n\n  Exponential: {\n\n    In: function ( k ) {\n\n      return k === 0 ? 0 : Math.pow( 1024, k - 1 );\n\n    },\n\n    Out: function ( k ) {\n\n      return k === 1 ? 1 : 1 - Math.pow( 2, - 10 * k );\n\n    },\n\n    InOut: function ( k ) {\n\n      if ( k === 0 ) return 0;\n      if ( k === 1 ) return 1;\n      if ( ( k *= 2 ) < 1 ) return 0.5 * Math.pow( 1024, k - 1 );\n      return 0.5 * ( - Math.pow( 2, - 10 * ( k - 1 ) ) + 2 );\n\n    }\n\n  },\n\n  Circular: {\n\n    In: function ( k ) {\n\n      return 1 - Math.sqrt( 1 - k * k );\n\n    },\n\n    Out: function ( k ) {\n\n      return Math.sqrt( 1 - ( --k * k ) );\n\n    },\n\n    InOut: function ( k ) {\n\n      if ( ( k *= 2 ) < 1) return - 0.5 * ( Math.sqrt( 1 - k * k) - 1);\n      return 0.5 * ( Math.sqrt( 1 - ( k -= 2) * k) + 1);\n\n    }\n\n  },\n\n  Elastic: {\n\n    In: function ( k ) {\n\n      var s, a = 0.1, p = 0.4;\n      if ( k === 0 ) return 0;\n      if ( k === 1 ) return 1;\n      if ( !a || a < 1 ) { a = 1; s = p / 4; }\n      else s = p * Math.asin( 1 / a ) / ( 2 * Math.PI );\n      return - ( a * Math.pow( 2, 10 * ( k -= 1 ) ) * Math.sin( ( k - s ) * ( 2 * Math.PI ) / p ) );\n\n    },\n\n    Out: function ( k ) {\n\n      var s, a = 0.1, p = 0.4;\n      if ( k === 0 ) return 0;\n      if ( k === 1 ) return 1;\n      if ( !a || a < 1 ) { a = 1; s = p / 4; }\n      else s = p * Math.asin( 1 / a ) / ( 2 * Math.PI );\n      return ( a * Math.pow( 2, - 10 * k) * Math.sin( ( k - s ) * ( 2 * Math.PI ) / p ) + 1 );\n\n    },\n\n    InOut: function ( k ) {\n\n      var s, a = 0.1, p = 0.4;\n      if ( k === 0 ) return 0;\n      if ( k === 1 ) return 1;\n      if ( !a || a < 1 ) { a = 1; s = p / 4; }\n      else s = p * Math.asin( 1 / a ) / ( 2 * Math.PI );\n      if ( ( k *= 2 ) < 1 ) return - 0.5 * ( a * Math.pow( 2, 10 * ( k -= 1 ) ) * Math.sin( ( k - s ) * ( 2 * Math.PI ) / p ) );\n      return a * Math.pow( 2, -10 * ( k -= 1 ) ) * Math.sin( ( k - s ) * ( 2 * Math.PI ) / p ) * 0.5 + 1;\n\n    }\n\n  },\n\n  Back: {\n\n    In: function ( k ) {\n\n      var s = 1.70158;\n      return k * k * ( ( s + 1 ) * k - s );\n\n    },\n\n    Out: function ( k ) {\n\n      var s = 1.70158;\n      return --k * k * ( ( s + 1 ) * k + s ) + 1;\n\n    },\n\n    InOut: function ( k ) {\n\n      var s = 1.70158 * 1.525;\n      if ( ( k *= 2 ) < 1 ) return 0.5 * ( k * k * ( ( s + 1 ) * k - s ) );\n      return 0.5 * ( ( k -= 2 ) * k * ( ( s + 1 ) * k + s ) + 2 );\n\n    }\n\n  },\n\n  Bounce: {\n\n    In: function ( k ) {\n\n      return 1 - TWEEN.Easing.Bounce.Out( 1 - k );\n\n    },\n\n    Out: function ( k ) {\n\n      if ( k < ( 1 / 2.75 ) ) {\n\n        return 7.5625 * k * k;\n\n      } else if ( k < ( 2 / 2.75 ) ) {\n\n        return 7.5625 * ( k -= ( 1.5 / 2.75 ) ) * k + 0.75;\n\n      } else if ( k < ( 2.5 / 2.75 ) ) {\n\n        return 7.5625 * ( k -= ( 2.25 / 2.75 ) ) * k + 0.9375;\n\n      } else {\n\n        return 7.5625 * ( k -= ( 2.625 / 2.75 ) ) * k + 0.984375;\n\n      }\n\n    },\n\n    InOut: function ( k ) {\n\n      if ( k < 0.5 ) return TWEEN.Easing.Bounce.In( k * 2 ) * 0.5;\n      return TWEEN.Easing.Bounce.Out( k * 2 - 1 ) * 0.5 + 0.5;\n\n    }\n\n  }\n\n};\n\nTWEEN.Interpolation = {\n\n  Linear: function ( v, k ) {\n\n    var m = v.length - 1, f = m * k, i = Math.floor( f ), fn = TWEEN.Interpolation.Utils.Linear;\n\n    if ( k < 0 ) return fn( v[ 0 ], v[ 1 ], f );\n    if ( k > 1 ) return fn( v[ m ], v[ m - 1 ], m - f );\n\n    return fn( v[ i ], v[ i + 1 > m ? m : i + 1 ], f - i );\n\n  },\n\n  Bezier: function ( v, k ) {\n\n    var b = 0, n = v.length - 1, pw = Math.pow, bn = TWEEN.Interpolation.Utils.Bernstein, i;\n\n    for ( i = 0; i <= n; i++ ) {\n      b += pw( 1 - k, n - i ) * pw( k, i ) * v[ i ] * bn( n, i );\n    }\n\n    return b;\n\n  },\n\n  CatmullRom: function ( v, k ) {\n\n    var m = v.length - 1, f = m * k, i = Math.floor( f ), fn = TWEEN.Interpolation.Utils.CatmullRom;\n\n    if ( v[ 0 ] === v[ m ] ) {\n\n      if ( k < 0 ) i = Math.floor( f = m * ( 1 + k ) );\n\n      return fn( v[ ( i - 1 + m ) % m ], v[ i ], v[ ( i + 1 ) % m ], v[ ( i + 2 ) % m ], f - i );\n\n    } else {\n\n      if ( k < 0 ) return v[ 0 ] - ( fn( v[ 0 ], v[ 0 ], v[ 1 ], v[ 1 ], -f ) - v[ 0 ] );\n      if ( k > 1 ) return v[ m ] - ( fn( v[ m ], v[ m ], v[ m - 1 ], v[ m - 1 ], f - m ) - v[ m ] );\n\n      return fn( v[ i ? i - 1 : 0 ], v[ i ], v[ m < i + 1 ? m : i + 1 ], v[ m < i + 2 ? m : i + 2 ], f - i );\n\n    }\n\n  },\n\n  Utils: {\n\n    Linear: function ( p0, p1, t ) {\n\n      return ( p1 - p0 ) * t + p0;\n\n    },\n\n    Bernstein: function ( n , i ) {\n\n      var fc = TWEEN.Interpolation.Utils.Factorial;\n      return fc( n ) / fc( i ) / fc( n - i );\n\n    },\n\n    Factorial: ( function () {\n\n      var a = [ 1 ];\n\n      return function ( n ) {\n\n        var s = 1, i;\n        if ( a[ n ] ) return a[ n ];\n        for ( i = n; i > 1; i-- ) s *= i;\n        return a[ n ] = s;\n\n      };\n\n    } )(),\n\n    CatmullRom: function ( p0, p1, p2, p3, t ) {\n\n      var v0 = ( p2 - p0 ) * 0.5, v1 = ( p3 - p1 ) * 0.5, t2 = t * t, t3 = t * t2;\n      return ( 2 * p1 - 2 * p2 + v0 + v1 ) * t3 + ( - 3 * p1 + 3 * p2 - 2 * v0 - v1 ) * t2 + v0 * t + p1;\n\n    }\n\n  }\n\n};\n\nmodule.exports = TWEEN;","<template>\n  <div id=\"sceneContainer\" ref=\"sceneContainer\">\n    <!--    <button id=\"del\" @click.stop=\"deleteGroup\">删除标注</button>-->\n    <button\n      class=\"pass_button\"\n      @click.stop=\"() => (state.renderPass = !state.renderPass)\"\n    >\n      标签<span class=\"highlight\">{{ state.renderPass ? \"开\" : \"关\" }}</span>\n    </button>\n    <div class=\"phaseOf\">\n      <button class=\"phaseOf_c\" @click.stop=\"cameraToPhaseOf('1')\">一期</button>\n      <button class=\"phaseOf_c\" @click.stop=\"cameraToPhaseOf('2')\">二期</button>\n      <button class=\"phaseOf_c\" @click.stop=\"cameraToPhaseOf('3')\">三期</button>\n      <button class=\"phaseOf_c\" @click.stop=\"cameraToPhaseOf('4')\">四期</button>\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport { ref, reactive, onMounted, onBeforeUnmount, watch } from \"vue\";\nimport Base3D from \"../utils/base3D\";\nimport threeUniversal from \"../utils/threeUniversal\";\nimport * as THREE from \"three\";\nimport { Water } from \"three/examples/jsm/objects/Water\";\n\n// 模型解析\nimport { GLTFLoader } from \"three/examples/jsm/loaders/GLTFLoader\";\nimport * as dat from \"dat.gui\";\nimport { FontLoader } from \"three/examples/jsm/loaders/FontLoader\";\nimport { TextGeometry } from \"three/examples/jsm/geometries/TextGeometry\";\nimport TWEEN from \"tween/tween.js\";\n// const clock = new THREE.Clock();\nlet params; // GUI config\nlet data = reactive({\n  base3D: {},\n});\nconst sceneContainer = ref(null);\nlet pointsArr = [\n  // [-80, -20, 0],\n  // [-70, 20, 0],\n  // [0, 0, 0],\n  // [70, 30, 0],\n  // [20, 40, 0],\n  [3, 44, 0],\n  [3, 47, 0],\n];\nlet pointsArr1 = [\n  [3, 50.5, 0],\n  [3, 53, 0],\n  [17, 53, 0],\n  // [0, 0, 4.8],\n  // [0, 119.355, 4.8],\n];\nlet water;\nlet waterGeometry;\nlet PopUpMesh; // 标注框\nlet taggingText; // 标注内容\nlet texture; // 管贴图\nlet CylinderMesh; // 圆柱\nlet textureOuter; //管壁\nlet stripMesh; // 圆柱\nlet cylinderTexture; // 管箭头\nlet labels3d = [\n  { x: -106, y: 4, z: 211, name: \"一期沉沙池\" },\n  { x: -106, y: 4, z: 148, name: \"二期沉沙池\" },\n  { x: -106, y: 4, z: 178, name: \"三期沉沙池\" },\n  { x: -292, y: 4, z: 58, name: \"一期反应池\" },\n  { x: -367, y: 4, z: 58, name: \"一期沉淀池\" },\n  { x: -167, y: 4, z: 58, name: \"一期沉淀池\" },\n  { x: -197, y: 4, z: 237, name: \"一二期消毒池\" },\n  { x: -430, y: 4, z: -140, name: \"三期生化池\" },\n  { x: -246, y: 4, z: -140, name: \"二期反应池\" },\n  { x: -478, y: 4, z: 60, name: \"三期二沉池\" },\n  { x: -474, y: 4, z: 205, name: \"三期消毒池\" },\n  { x: -48, y: 4, z: 245, name: \"一二三期提升泵房\" },\n  { x: 25, y: 4, z: 174, name: \"污泥大转盘\" },\n  { x: -48, y: 4, z: 100, name: \"四期提升泵房\" },\n  { x: 49, y: 4, z: 100, name: \"四期沉沙池\" },\n  { x: 106, y: 4, z: 0, name: \"四期生化池\" },\n  { x: 106, y: 4, z: -100, name: \"四期二沉池\" },\n  { x: 234, y: 4, z: -150, name: \"高效沉淀池\" },\n  { x: 60, y: 4, z: -167, name: \"转盘滤池\" },\n  { x: -30, y: 4, z: -170, name: \"紫外消毒池\" },\n]; // 标注\n// rotation_z: Math.PI * 0.5, 横向 r->l\nlet tubesArr_ws = [\n  {\n    x: -262.3, // h2\n    y: -7,\n    z: 18,\n    height: 20,\n    rotation_z: Math.PI * 0.5,\n  },\n  {\n    x: -263.5, // h4\n    y: -7,\n    z: 90,\n    height: 20,\n    rotation_z: Math.PI * 0.5,\n  },\n  {\n    x: -253, // s2\n    y: -7,\n    z: 79.5,\n    height: 122,\n    rotation_z: Math.PI,\n  },\n  {\n    x: -197.5, // h6\n    y: -7,\n    z: 140,\n    height: 110,\n    rotation_z: Math.PI * 0.5,\n  },\n  {\n    x: -143.3, // s3\n    y: -7,\n    z: 174.5,\n    height: 68,\n    rotation_z: Math.PI,\n  },\n  {\n    x: -54, // s4\n    y: -7,\n    z: 255,\n    height: 19,\n    rotation_z: Math.PI,\n  },\n  {\n    x: -61.2, // s5\n    y: -9,\n    z: 219,\n    height: 11,\n    rotation_z: Math.PI,\n  },\n  {\n    x: -136.2, // h7_l\n    y: -7,\n    z: 207.8,\n    height: 13,\n    rotation_z: Math.PI * 0.5,\n  },\n  {\n    x: -73, // h7_r\n    y: -9,\n    z: 213,\n    height: 25,\n    rotation_z: Math.PI * 0.5,\n  },\n  {\n    x: -54, // s8\n    y: -7,\n    z: 290,\n    height: 19,\n    rotation_z: Math.PI,\n  },\n  {\n    x: -18.3, //cc2_4_s4\n    y: -7,\n    z: -65,\n    height: 30,\n    rotation_z: Math.PI,\n  },\n  {\n    x: 97, //cc2_4_s5\n    y: -7,\n    z: -65,\n    height: 30,\n    rotation_z: Math.PI,\n  },\n  {\n    x: 225, //cc2_4_s6\n    y: -7,\n    z: -65,\n    height: 30,\n    rotation_z: Math.PI,\n  },\n];\nlet tubesArr_cs = [\n  {\n    x: -411.5, //cd_1_h1\n    y: -7,\n    z: 5,\n    height: 30,\n    rotation_z: Math.PI * 0.5,\n  },\n  {\n    x: -427, //cd_1_s1\n    y: -7,\n    z: 78.5,\n    height: 148,\n    rotation_z: 0,\n  },\n  {\n    x: -411.5, //cd_1_h3\n    y: -7,\n    z: 93,\n    height: 30,\n    rotation_z: Math.PI * 0.5,\n  },\n  {\n    x: -295, //cd_1_h5\n    y: -7,\n    z: 153,\n    height: 265,\n    rotation_z: Math.PI * 0.5,\n    rotation_y: Math.PI,\n  },\n  {\n    x: -162, // xdc_12_s6\n    y: -7,\n    z: 161.3,\n    height: 18,\n  },\n  {\n    x: -185, // xdc_12_s1\n    y: -7,\n    z: 265,\n    height: 13,\n  },\n  {\n    x: -168, // xdc_12_s2\n    y: -7,\n    // z: 260,\n    z: 265,\n    height: 13,\n  },\n  {\n    x: -184.3, // xdc_12_s3\n    y: -7,\n    z: 196.3,\n    height: 30,\n  },\n  {\n    x: -477, //xdc_3_s1\n    y: -7,\n    z: 183,\n    height: 34,\n  },\n  {\n    x: -485, //shc_3_s1\n    y: -7,\n    z: -81,\n    height: 64,\n  },\n\n  {\n    x: -485, //cc2_3_s2\n    y: -7,\n    z: 58,\n    height: 13,\n  },\n  {\n    x: -366, //fyc_2_s1\n    y: -7,\n    z: -111,\n    height: 125,\n  },\n  {\n    x: -357.5, //fyc_2_h1\n    y: -7,\n    z: -97,\n    height: 16,\n    rotation_z: Math.PI * 0.5,\n  },\n  {\n    x: -357.5, //fyc_2_h2\n    y: -7,\n    z: -173,\n    height: 16,\n    rotation_z: Math.PI * 0.5,\n  },\n  {\n    x: -357.5, //fyc_2_h2\n    y: -7,\n    z: -173,\n    height: 16,\n    rotation_z: Math.PI * 0.5,\n  },\n  {\n    x: -402, //fyc_2_h3\n    y: -7,\n    z: -48,\n    height: 73.6,\n    rotation_z: Math.PI * 0.5,\n  },\n  {\n    x: -439.5, //fyc_2_s2\n    y: -7,\n    z: 66.5,\n    height: 230,\n  },\n  {\n    x: -312.5, //fyc_2_h4\n    y: -7,\n    z: 182,\n    height: 255,\n    rotation_z: Math.PI * 0.5,\n    rotation_y: Math.PI,\n  },\n  {\n    x: -477, //xdc_3_s2\n    y: -7,\n    z: 225,\n    height: 18,\n  },\n  {\n    x: -350, //xdc_3_h1\n    y: -7,\n    z: 234.5,\n    height: 255,\n    rotation_z: Math.PI * 0.5,\n    rotation_y: Math.PI,\n  },\n  {\n    x: -159, //xdc_3_h2\n    y: -7,\n    z: 272,\n    height: 125,\n    rotation_z: Math.PI * 0.5,\n    rotation_y: Math.PI,\n  },\n  {\n    x: -222, //xdc_3_s3\n    y: -7,\n    z: 253.2,\n    height: 38.8,\n  },\n  {\n    x: -76, //cs_4_s1\n    y: -7,\n    z: -13.5,\n    height: 330,\n  },\n  {\n    x: -59, // cs_4_h1\n    y: -7,\n    z: -179,\n    height: 35,\n    rotation_z: Math.PI * 0.5,\n  },\n  {\n    x: -47, // cs_4_h2\n    y: -7,\n    z: 151,\n    height: 57,\n    rotation_z: Math.PI * 0.5,\n    rotation_y: Math.PI,\n  },\n  {\n    x: -19.2, //cs_4_s2\n    y: -7,\n    z: 203,\n    height: 105,\n  },\n  {\n    x: -47, // cs_4_h3\n    y: -7,\n    z: 256,\n    height: 57,\n    rotation_z: Math.PI * 0.5,\n  },\n  {\n    x: -95.5, //cs_4_s4\n    y: -7,\n    z: 283,\n    height: 55,\n  },\n  {\n    x: -57.5, // cs_4_h3\n    y: -7,\n    z: 256,\n    height: 77,\n    rotation_z: Math.PI * 0.5,\n  },\n  {\n    x: 0, // zplc_h1\n    y: -7,\n    z: -179,\n    height: 40,\n    rotation_z: Math.PI * 0.5,\n  },\n  {\n    x: 57, //zplc_s1\n    y: -7,\n    z: -152,\n    height: 20,\n    rotation_z: Math.PI,\n  },\n  {\n    x: 0, //zplc_s2\n    y: -7,\n    z: -209,\n    height: 60,\n  },\n  {\n    x: -18.3, //cc2_4_s1\n    y: -7,\n    z: -132,\n    height: 20,\n    rotation_z: Math.PI,\n  },\n  {\n    x: 97, //cc2_4_s2\n    y: -7,\n    z: -132,\n    height: 20,\n    rotation_z: Math.PI,\n  },\n  {\n    x: 224.7, //cc2_4_s3\n    y: -7,\n    z: -132,\n    height: 20,\n    rotation_z: Math.PI,\n  },\n  {\n    x: 236, // gxcdc_s4\n    y: -7,\n    z: -230.7,\n    height: 20,\n    rotation_z: Math.PI,\n  },\n  {\n    x: 118, // zplc_h2\n    y: -7,\n    z: -240,\n    height: 237,\n    rotation_z: Math.PI * 0.5,\n  },\n  {\n    x: 39.5, // cc2_4_h1\n    y: -7,\n    z: -142,\n    height: 116,\n    rotation_z: Math.PI * 0.5,\n  },\n  {\n    x: 150.8, // gxcdc_h1\n    y: -7,\n    z: -211,\n    height: 90,\n    rotation_z: Math.PI * 0.5,\n  },\n  {\n    x: 151, // gxcdc_h2\n    y: -7,\n    z: -180.3,\n    height: 50,\n    rotation_z: Math.PI * 0.5,\n  },\n  {\n    x: 199.5, // cc2_4_h2\n    y: -7,\n    z: -141.3,\n    height: 49,\n    rotation_z: Math.PI * 0.5,\n  },\n  {\n    x: 115.8, // gxcdc_h3\n    y: -7,\n    z: -165.5,\n    height: 20,\n    rotation_z: Math.PI * 0.5,\n  },\n  {\n    x: 106.5, // gxcdc_s1\n    y: -7,\n    z: -188,\n    height: 45,\n  },\n  {\n    x: 126.5, // gxcdc_s2\n    y: -7,\n    z: -173,\n    height: 16,\n  },\n  {\n    x: 175.4, // gxcdc_s3\n    y: -7,\n    z: -161,\n    height: 39,\n  },\n];\nlet waterSurface_A = {}; // 动态水面\nlet allTubes = {};\nlet waterArr = [\n  {\n    width: 70, // 污泥大转盘\n    height: 75,\n    color: 0xe4943a,\n    position: {\n      x: 23,\n      y: -6,\n      z: 205,\n    },\n  },\n  {\n    width: 48, // 一二期消毒池  down\n    height: 53,\n    color: 0xacece5,\n    position: {\n      x: -180,\n      y: -5,\n      z: 232.5,\n    },\n  },\n  {\n    width: 16, //// 一二期消毒池  up\n    height: 43,\n    color: 0xacece5,\n    position: {\n      x: -164,\n      y: -5,\n      z: 187,\n    },\n  },\n  {\n    width: 70, // 一期反应池\n    height: 169.5,\n    color: 0x001e0f,\n    position: {\n      x: -307,\n      y: -2.6,\n      z: 54.5,\n    },\n  },\n  {\n    width: 70,\n    height: 169.5, // 一期沉淀池\n    color: 0xb8e2a6,\n    position: {\n      x: -379,\n      y: -2.6,\n      z: 54.5,\n    },\n  },\n];\nlet loadedGltf = [];\nlet selectedObject = null;\nconst pointer = new THREE.Vector2();\nconst raycaster = new THREE.Raycaster();\n\nlet labelGroup = new THREE.Group();\nlabelGroup.name = \"labels\";\nlet spriteGroup = new THREE.Group();\nspriteGroup.name = \"labels_2d\";\n// 背景色， 标签开关\nlet state = reactive({\n  backgroundColor: \"#3cd4cf\",\n  renderPass: true,\n});\n\nonMounted(() => {\n  initScene();\n  animate();\n  // initGui();\n});\nonBeforeUnmount(() => {\n  try {\n    data.base3D.scene.clear();\n    data.base3D.renderer.dispose();\n    data.base3D.renderer.forceContextLoss();\n    data.base3D.renderer.content = null;\n    // cancelAnimationFrame(animationID); // 去除animationFrame\n    let gl = data.base3D.renderer.domElement.getContext(\"webgl\");\n    gl && gl.getExtension(\"WEBGL_lose_context\").loseContext();\n    // console.log(data.base3D.renderer.info); //查看memery字段即可\n  } catch (e) {\n    console.error(e);\n  }\n});\nwatch(\n  () => state.renderPass,\n  (n) => labelsGroupStatus(n)\n);\n\nfunction initScene() {\n  data.base3D = new Base3D(sceneContainer.value);\n  threeUniversal.addFloor(data.base3D.scene);\n  // document.addEventListener(\"mousedown\", onDocumentMouseDown);\n  document.addEventListener(\"mousedown\", onPointerClick);\n  loadLiedeModel(\"liede.gltf\"); // 污水厂模型\n  data.base3D.scene.add(spriteGroup);\n\n  // allPipeline();\n}\nfunction onDocumentMouseDown(event) {\n  let intersects = threeUniversal.getDocumentMouseDownCoord(event, data.base3D);\n  // 获取选中最近的 Mesh 对象\n  if (intersects.length !== 0 && intersects[0].object instanceof THREE.Mesh) {\n    let selectObject = intersects[0].object;\n    // console.log(intersects, selectObject);\n    // console.log(selectObject.geometry.boundingBox.max);\n    // console.log(selectObject.geometry.boundingBox.min);\n    // showObject(selectObject, event);\n    console.log(selectObject);\n  }\n}\n\nfunction loadLabels() {\n  // labels3d.map((item) => initLabels(item)); //  3d label\n  labels3d.map((item) => spriteImg(item)); // 2d sprite  label\n}\n\nfunction loadWaterSurface() {\n  waterArr.map((item, i) => (waterSurface_A[\"w\" + i] = initWater(item)));\n}\n\nfunction loadTubes() {\n  tubesArr_ws.map(\n    (item, i) =>\n      (allTubes[\"ws\" + i] = drawCylinder({ item, type: \"ws\", id: \"ws\" + i }))\n  );\n  /*  tubesArr_cs.map(\n    (item, i) =>\n      (allTubes[\"ys\" + i] = drawCylinder({ item, type: \"cs\", id: \"cs\" + i }))\n  );*/\n}\n\nfunction loadLiedeModel(model) {\n  return new Promise((resolve, reject) => {\n    const loader = new GLTFLoader();\n    loader.load(\n      \"static/model/\" + model,\n      (gltf) => {\n        gltf.scene.scale.x = 50;\n        gltf.scene.scale.y = 50;\n        gltf.scene.scale.z = 50;\n        data.base3D.scene.add(gltf.scene);\n        loadedGltf.push(gltf.scene.getObjectByName(\"rotation001\"));\n        loadedGltf.push(gltf.scene.getObjectByName(\"rotation002\"));\n        loadedGltf.push(gltf.scene.getObjectByName(\"rotation003\"));\n        loadedGltf.push(gltf.scene.getObjectByName(\"rotation004\"));\n        resolve(gltf);\n      }\n      // (xhr) => console.log((xhr.loaded / xhr.total) * 100 + \"% loaded\"),\n      // () => console.error(\"An error happened\")\n    );\n  }).then(() => {\n    // loadLabels(); // 标注\n    // loadTubes(); // 管线\n    // loadWaterSurface(); // 水面\n    labels3d.slice(0, 3).map((item) => createText(item)); // 3D fonts label\n  });\n}\n/**\n * 展示点击内容\n */\nfunction showObject(obj, event) {\n  console.log(obj);\n  // let key = obj.name;\n  // let objs = this.cabinetData.filter((item) => {\n  //   return item.code === key;\n  // });\n  // // 显示内容，高亮\n  // if (objs.length > 0) {\n  //   let oldOneMaterial = this.oldChildren.filter(\n  //     (item) => item.name === key\n  //   )[0];\n  //   obj.material = new THREE.MeshPhongMaterial({\n  //     color: 0xff0000,\n  //     map: oldOneMaterial.material.map,\n  //   });\n  //\n  //   this.texts = objs[0];\n  //   // 屏幕坐标\n  //   this.dragTop = event.clientY - 50;\n  //   this.dragLeft = event.clientX - 100;\n  // }\n}\n\n/*function allPipeline() {\n  tubeTexture1 = pipeConf(\n    {\n      points: pointsArr,\n      color: 0x4488ff,\n    },\n    {\n      points: pointsArr,\n      texture: \"images/allow2.png\",\n    }\n  );\n  tubeTexture2 = pipeConf(\n    {\n      points: pointsArr1,\n      color: 0x4411ee,\n    },\n    {\n      points: pointsArr1,\n      texture: \"images/allow2.png\",\n    }\n  );\n}\nfunction pipeConf(outerConf, innerConf) {\n  outerConf.radius = 1;\n  outerConf.opacity = 0.35;\n  innerConf.radius = 0.9;\n  const { texture: tubeTexture0, mesh: pipe0 } = creatPipe(outerConf);\n  const { texture: tubeTexture1, mesh: pipe1 } = creatPipe(innerConf);\n  data.base3D.scene.add(pipe0);\n  data.base3D.scene.add(pipe1);\n  outerPipeMesh = pipe0;\n  innerPipeMesh = pipe1;\n  return tubeTexture1;\n}\nfunction creatPipe(conf) {\n  const path = createPath(conf.points);\n  const geometry = new THREE.TubeGeometry(path, 100, conf.radius, 8, false);\n  const textureLoader = new THREE.TextureLoader();\n  let material;\n  if (conf.texture !== undefined) {\n    texture = textureLoader.load(conf.texture); // 图片贴图\n    // texture = new THREE.CanvasTexture(getTextCanvas(\"➯ ➮ ➯\")); // 文本贴图\n    // 设置阵列模式为 RepeatWrapping\n    texture.wrapS = THREE.RepeatWrapping;\n    texture.wrapT = THREE.RepeatWrapping;\n    // 设置x方向的偏移(沿着管道路径方向)，y方向默认1\n    // 等价texture.repeat= new THREE.Vector2(3,1)\n    texture.repeat.set(5, 1);\n    // texture.rotation = Math.PI;\n    // 图片贴图\n    // 模拟管线运动动画，将两个素材图按比例合并，然后生成贴图texture\n    material = new THREE.MeshPhongMaterial({\n      map: texture,\n      transparent: true,\n      depthTest: false, // 深度检测\n    });\n  } else {\n    material = new THREE.MeshPhongMaterial({\n      // map: texture,\n      color: conf.color,\n      transparent: true,\n      opacity: conf.opacity,\n      depthWrite: false, // 为true内部流动的液体会被遮挡无法显示\n    });\n  }\n  const mesh = new THREE.Mesh(geometry, material);\n  // mesh.rotation.z = Math.PI * 0.5; // 箭头方向\n  mesh.rotation.x = Math.PI * 0.5; //修改箭头在管壁的位置\n\n  return { texture, mesh };\n}\nfunction createPath(pointsArr) {\n  pointsArr = pointsArr.map((point) => new THREE.Vector3(...point));\n  // 利用CatmullRomCurve3 创建路径，不过是平滑的三维样条曲线\n  return new THREE.CatmullRomCurve3(pointsArr);\n}*/\n\nfunction animate(time) {\n  time *= 0.003;\n  // 水流\n  Object.keys(allTubes).forEach((item) => {\n    allTubes[item].textureOuter.offset.x = -(time * 0.2) % 1;\n    allTubes[item].cylinderTexture.offset.x = -(time * 1) % 1;\n  });\n  // 水面\n  Object.keys(waterSurface_A).forEach(\n    (item) =>\n      (waterSurface_A[item].material.uniforms[\"time\"].value += 1.0 / 660.0)\n  );\n  // modelChange(time);  // 转盘旋转动画\n  requestAnimationFrame(animate);\n  // render();\n}\n\n/**\n * @Description: 污泥转盘动画\n * @author parabellum\n * @date 2022/3/16\n */\nfunction modelChange(time) {\n  if (loadedGltf.length === 0) return;\n  loadedGltf.map((item) => {\n    switch (item.name) {\n      case \"rotation001\":\n        rotationY(item, time * 0.1);\n        break;\n      case \"rotation002\":\n        rotationY(item, time);\n        break;\n      case \"rotation003\":\n        rotationY(item, -time * 0.2);\n        break;\n      case \"rotation004\":\n        rotationY(item, time * 0.4);\n        break;\n    }\n  });\n}\n\n/**\n * 部件绕y轴方向旋转\n */\nfunction rotationY(parts, time) {\n  parts.rotation.y = time;\n}\n\n/**\n * 标注文字部分（3维）\n */\nfunction initLabels(labels_D) {\n  let { x, y, z, name } = labels_D;\n  let c_width = 200,\n    c_hight = 140;\n  //用canvas生成图片\n  let canvas = document.createElement(\"canvas\");\n  let ctx = canvas.getContext(\"2d\");\n  canvas.width = c_width;\n  canvas.height = c_hight;\n  //制作矩形\n  ctx.fillStyle = \"rgba(98,75,14,1)\";\n  // ctx.fillRect(0, 0, 300, 300);\n  ctx.fillRect(0, 0, c_width, c_hight * 0.22);\n  //设置文字\n  ctx.fillStyle = \"#FFDD77\";\n  // ctx.font = 'normal 8pt \"楷体\"';\n  ctx.font = 26 + 'px \"sans-serif';\n  ctx.textAlign = \"center\"; // 设置水平对齐方式\n  ctx.textBaseline = \"middle\"; // 设置垂直对齐方式\n  ctx.fillText(name, c_width / 2, (c_hight * 0.23) / 2); // canvas  水平垂直居中\n\n  /*let labels = \"测试标注\";\n  //文字换行\n  let len = parseInt(labels.length / 10);\n  for (let i = 0; i < len + 1; i++) {\n    let space = 10;\n    if (i === len) space = labels.length - len * 10;\n    // console.log(\"len+\" + len, \"space+\" + space);\n    let word = labels.substr(i * 10, space);\n    ctx.fillText(word, 20, 30 * (i + 1));\n  }*/\n  //生成图片\n  let url = canvas.toDataURL(\"image/png\");\n\n  //将图片构建到纹理中\n  let geometry1 = new THREE.PlaneGeometry(c_width * 0.1, c_hight * 0.1);\n  let texture = THREE.ImageUtils.loadTexture(url, null, () => {});\n\n  let material1 = new THREE.MeshBasicMaterial({\n    map: texture,\n    side: THREE.DoubleSide,\n    opacity: 1,\n    transparent: true,\n  });\n\n  taggingText = new THREE.Mesh(geometry1, material1);\n  taggingText.position.set(x, y, z);\n  labelGroup.add(taggingText);\n  // data.base3D.scene.add(taggingText);\n  addPopUpMesh(c_width, c_hight, x, y, z);\n}\n/**\n * 标注（3维）\n */\nfunction addPopUpMesh(c_width, c_hight, x, y, z) {\n  let texture, material;\n  const textureLoader = new THREE.TextureLoader();\n  let geometry = new THREE.PlaneGeometry(c_width * 0.1, c_hight * 0.1);\n  texture = textureLoader.load(\"images/label.png\"); // 图片贴图\n  texture.wrapS = THREE.RepeatWrapping;\n  texture.wrapT = THREE.RepeatWrapping;\n  material = new THREE.MeshPhongMaterial({\n    map: texture,\n    transparent: true,\n    // depthTest: false, // 深度检测\n    // side: THREE.DoubleSide,\n  });\n  PopUpMesh = new THREE.Mesh(geometry, material);\n  PopUpMesh.position.set(x, y, z);\n  labelGroup.add(PopUpMesh);\n  data.base3D.scene.add(labelGroup);\n\n  /*let allChildren = data.base3D.scene.children;\n  for (let i = allChildren.length - 1; i >= 0; i--) {\n    if (allChildren[i] instanceof THREE.Group) {\n      console.log(allChildren[i]);\n\n      setTimeout(() => {\n        console.log(\"delete group\");\n        data.base3D.scene.remove(allChildren[i]);\n      }, 1000 * 5);\n      // scene.remove(allChildren[i]);\n    }\n  }*/\n}\n\n/**\n * 标注 （2维）\n */\nfunction spriteImg(labels_D) {\n  let { x, y, z, name } = labels_D;\n  let texture = new THREE.ImageUtils.loadTexture(\"images/label.png\");\n  texture.minFilter = THREE.NearestFilter; // 解决图片的失真问题，最近渲染\n  texture.needsUpdate = true;\n  texture.wrapS = THREE.RepeatWrapping;\n  texture.wrapT = THREE.RepeatWrapping;\n  let material = new THREE.SpriteMaterial({\n    map: texture,\n    // useScreenCoordinates: false,\n    // alignment: THREE.SpriteAlignment.center,\n    transparent: true, //透明度\n  });\n  let sprite = new THREE.Sprite(material);\n  sprite.scale.set(10, 10, 10);\n  sprite.position.set(x, y, z);\n  sprite.name = name;\n  spriteGroup.add(sprite);\n  spriteText(labels_D);\n}\nfunction spriteText(labels_D) {\n  let { x, y, z, name } = labels_D;\n  let c_width = 200,\n    c_hight = 140;\n  let canvas = document.createElement(\"canvas\");\n  let ctx = canvas.getContext(\"2d\");\n  canvas.width = c_width;\n  canvas.height = c_hight;\n  //制作矩形\n  ctx.fillStyle = \"rgba(98,75,14,1)\";\n  ctx.fillRect(0, 0, c_width, c_hight * 0.22);\n  ctx.fillStyle = \"#FFDD77\";\n  ctx.font = 24 + 'px \"sans-serif';\n  ctx.textAlign = \"center\"; // 设置水平对齐方式\n  ctx.textBaseline = \"middle\"; // 设置垂直对齐方式\n  ctx.fillText(name, c_width / 2, (c_hight * 0.23) / 2); // canvas  水平垂直居中\n\n  let texture = new THREE.Texture(canvas);\n  texture.needsUpdate = true;\n  let material = new THREE.SpriteMaterial({\n    map: texture,\n    // useScreenCoordinates: false,\n    // alignment: THREE.SpriteAlignment.center,\n    transparent: true,\n  });\n  let sprite = new THREE.Sprite(material);\n  sprite.scale.set(10, 10, 10);\n  sprite.position.set(x, y, z);\n  spriteGroup.add(sprite);\n}\n\n/**\n * 根据组名称获取组\n */\nfunction labelsGroupStatus(status) {\n  data.base3D.scene.traverse((obj) => {\n    if (obj.type === \"Group\" && obj.name === \"labels_2d\") obj.visible = status;\n  });\n}\n\n// function PlaneGeometry(mesh) {\n//   function generateGeometry() {\n//     updateGroupGeometry(mesh, new PlaneGeometry(data1.width, data1.height));\n//   }\n//\n//   const folder = gui.addFolder(\"THREE.PlaneGeometry\");\n//   folder.add(data1, \"width\", 1, 30).onChange(generateGeometry);\n//   folder.add(data1, \"height\", 1, 30).onChange(generateGeometry);\n//\n//   generateGeometry();\n// }\n//\n// function updateGroupGeometry(mesh, geometry) {\n//   mesh.children[0].geometry.dispose();\n//   mesh.children[1].geometry.dispose();\n//\n//   mesh.children[1].geometry = geometry;\n// }\n\nfunction initWater(conf) {\n  let { width, height, color, position } = conf;\n  waterGeometry = new THREE.PlaneGeometry(width, height);\n\n  water = new Water(waterGeometry, {\n    textureWidth: 512,\n    textureHeight: 512,\n    waterNormals: new THREE.TextureLoader().load(\n      \"images/waternormals.jpg\",\n      (texture) => {\n        texture.wrapS = texture.wrapT = THREE.RepeatWrapping;\n      }\n    ),\n    sunDirection: new THREE.Vector3(),\n    sunColor: 0xffffff,\n    waterColor: color,\n    distortionScale: 3.7,\n    // fog: data.base3d.scene.fog !== undefined,\n  });\n  water.rotation.x = -Math.PI / 2;\n  water.position.x = position.x;\n  water.position.y = position.y;\n  water.position.z = position.z;\n  data.base3D.scene.add(water);\n  return water;\n}\n\n/**\n * GUI相关\n */\nfunction initGui() {\n  let datGui = new dat.GUI();\n  params = {\n    scaleX: 1,\n    scaleY: 1,\n    scaleZ: 1,\n\n    rotationX: 1.6, // 竖向\n    rotationZ: 0, // 竖向\n    // rotationX: 0, // 横向\n    // rotationZ: 1.56, // 横向\n    rotationY: 0,\n\n    positionX: 175,\n    positionY: -6.3,\n    positionZ: -160,\n\n    color: \"#ffffff\",\n    addFunction: () => console.log(\"// 方法预留\"),\n  };\n  datGui.add(params, \"addFunction\");\n  // (对象，属性，最小值，最大值,步长）.name(\"别名\").onchange(function)\n  let meshScale = datGui.addFolder(\"缩放\");\n  meshScale\n    .add(params, \"scaleX\", 0, 10, 0.01)\n    .name(\"沿x轴缩放\")\n    .onChange(updateMesh);\n  meshScale\n    .add(params, \"scaleY\", 0, 20, 0.001)\n    .name(\"沿y轴缩放\")\n    .onChange(updateMesh);\n  meshScale\n    .add(params, \"scaleZ\", 0, 10, 0.01)\n    .name(\"沿z轴缩放\")\n    .onChange(updateMesh);\n\n  let meshPosition = datGui.addFolder(\"位置\"); // 位置\n  meshPosition\n    .add(params, \"positionX\", -600, 400, 0.05)\n    .name(\"沿x轴移动\")\n    .onChange(updateMesh);\n  meshPosition\n    .add(params, \"positionY\", -10, 10, 0.1)\n    .name(\"沿y轴移动\")\n    .onChange(updateMesh);\n  meshPosition\n    .add(params, \"positionZ\", -400, 400, 0.05)\n    .name(\"沿z轴移动\")\n    .onChange(updateMesh);\n  meshPosition.open(); // 树状结构默认打开\n  let meshRotation = datGui.addFolder(\"旋转\"); //旋转\n  meshRotation\n    .add(params, \"rotationX\", 0, Math.PI * 2, 0.001)\n    .name(\"沿x轴旋转\")\n    .onChange(updateMesh);\n  meshRotation\n    .add(params, \"rotationY\", 0, Math.PI * 2, 0.001)\n    .name(\"沿y轴旋转\")\n    .onChange(updateMesh);\n  meshRotation\n    .add(params, \"rotationZ\", 0, Math.PI * 2, 0.001)\n    .name(\"沿z轴旋转\")\n    .onChange(updateMesh);\n\n  // 水面颜色\n  /*  datGui.addColor(params, \"color\").onChange((value) => {\n    water.material.uniforms[\"color\"].value.set(value);\n  });*/\n}\nfunction updateMesh() {\n  // let meshChange = stripMesh; // 将meshChange赋值为需要变换的Mesh对象\n  let meshChange = CylinderMesh; // 管线\n  // let meshChange = taggingText; // 标注\n  // let meshChange = water; // 水面\n  //缩放矩阵\n  let scaleM = new THREE.Matrix4();\n  scaleM.makeScale(params.scaleX, params.scaleY, params.scaleZ);\n\n  //生成旋转矩阵\n  let rotaMX = new THREE.Matrix4();\n  rotaMX.makeRotationX(params.rotationX);\n  let rotaMY = new THREE.Matrix4();\n  rotaMY.makeRotationY(params.rotationY);\n  let rotaMZ = new THREE.Matrix4();\n  rotaMZ.makeRotationZ(params.rotationZ);\n  rotaMZ.multiply(rotaMY);\n  rotaMZ.multiply(rotaMX);\n\n  //生成位移矩阵\n  let translationM = new THREE.Matrix4();\n  translationM.makeTranslation(\n    params.positionX,\n    params.positionY,\n    params.positionZ\n  );\n\n  //生成需要使用的矩阵\n  let matrix = new THREE.Matrix4();\n  //将矩阵赋值给模型\n  meshChange.matrix = matrix;\n  matrix.multiply(translationM);\n  matrix.multiply(rotaMZ);\n  matrix.multiply(scaleM);\n  //使用矩阵更新模型的信息\n  meshChange.matrix.decompose(\n    meshChange.position,\n    meshChange.quaternion,\n    meshChange.scale\n  );\n}\n\nfunction drawCylinder({ item, type }) {\n  let radius = 0.7;\n  let outerImg, image, rotation_y, rotation_z;\n  let { x, y, z, height } = item;\n  item.rotation_z !== undefined\n    ? (rotation_z = item.rotation_z)\n    : (rotation_z = 0);\n  item.rotation_y !== undefined\n    ? (rotation_y = item.rotation_y)\n    : (rotation_y = 0);\n  type === \"ws\" ? (outerImg = \"outerGreen.png\") : (outerImg = \"outerBlue.png\");\n  type === \"cs\" ? (image = \"allow2.png\") : (image = \"allow_rain.png\");\n\n  // 创建管道\n  const radiusTop = radius;\n  const radiusBottom = radius;\n  const radiusSegments = 30; // 管壁平滑度， 越大越平滑\n  const heightSegments = 200;\n  const openEnded = false;\n  const geometry = new THREE.CylinderBufferGeometry(\n    radiusTop,\n    radiusBottom,\n    height,\n    radiusSegments,\n    heightSegments,\n    openEnded\n  );\n  textureOuter = new THREE.TextureLoader().load(\"images/\" + outerImg);\n  textureOuter.wrapS = THREE.RepeatWrapping;\n  textureOuter.wrapT = THREE.RepeatWrapping;\n  textureOuter.repeat.x = height / 4;\n  textureOuter.repeat.y = 1;\n  // texture.repeat.z = -40;\n  textureOuter.rotation = Math.PI * 0.5;\n\n  const material = new THREE.MeshBasicMaterial({\n    map: textureOuter,\n    side: THREE.DoubleSide,\n    depthWrite: false,\n    depthTest: false,\n    transparent: true,\n    // opacity: 0.4,\n    /*   color,\n    transparent: true,\n    opacity: 0.65,\n    depthWrite: false, // 为true内部流动的液体会被遮挡无法显示\n    // color: \"#318414\",\n    // emissive: \"#318414\",\n    // specular: \"#22842c\",\n    shininess: 10,\n    shading: THREE.FlatShading,*/\n  });\n  CylinderMesh = new THREE.Mesh(geometry, material);\n  CylinderMesh.rotation.x = Math.PI * 0.5;\n  CylinderMesh.rotation.y = rotation_y;\n  CylinderMesh.rotation.z = rotation_z;\n  CylinderMesh.position.set(x, y, z);\n  data.base3D.scene.add(CylinderMesh);\n\n  // CylinderMesh.rotation.z = Math.PI * 0.5; // 箭头方向\n  // CylinderMesh.rotation.x = Math.PI * 0.6; //修改箭头在管壁的位置\n\n  // 管中心平面\n  cylinderTexture = new THREE.TextureLoader().load(\"images/\" + image);\n  cylinderTexture.wrapS = THREE.RepeatWrapping;\n  cylinderTexture.wrapT = THREE.RepeatWrapping;\n  cylinderTexture.repeat.x = height / 5; // x方向的箭头密度\n  cylinderTexture.repeat.y = 1; // y方向的箭头密度\n  // texture.repeat.z = -40;\n  cylinderTexture.rotation = Math.PI * 0.5;\n  const stripGeo = new THREE.PlaneBufferGeometry(radiusTop * 1.7, height);\n  const stripMat = new THREE.MeshBasicMaterial({\n    map: cylinderTexture,\n    // opacity: 0.5,\n    side: THREE.DoubleSide,\n    depthWrite: false,\n    depthTest: false,\n    transparent: true,\n  });\n  stripMesh = new THREE.Mesh(stripGeo, stripMat);\n  stripMesh.position.set(x, y, z);\n  stripMesh.rotation.x = Math.PI * 0.5;\n  stripMesh.rotation.y = rotation_y;\n  stripMesh.rotation.z = rotation_z;\n  data.base3D.scene.add(stripMesh);\n\n  requestAnimationFrame(animate);\n\n  return { cylinderTexture, textureOuter };\n  // return cylinderTexture;\n}\n\n/**\n * 点击获取精灵标签\n * @param event\n */\nfunction onPointerClick(event) {\n  if (selectedObject) {\n    selectedObject.material.color.set(\"#FD7\");\n    selectedObject = null;\n  }\n  pointer.x = (event.clientX / window.innerWidth) * 2 - 1;\n  pointer.y = -(event.clientY / window.innerHeight) * 2 + 1;\n  raycaster.setFromCamera(pointer, data.base3D.camera);\n  const intersects = raycaster.intersectObject(spriteGroup, true);\n  if (intersects.length < 0) return;\n  const res = intersects.filter((res) => res && res.object)[0];\n  if (res && res.object) {\n    selectedObject = res.object;\n    selectedObject.material.color.set(\"#f00\");\n  }\n}\n\n/**\n *使用 Tween.js 作为间补动画\n */\nfunction cameraToPhaseOf(item) {\n  switch (item) {\n    case \"1\":\n      break;\n    case \"2\":\n      break;\n    case \"3\":\n      break;\n    case \"4\":\n      break;\n    default:\n      break;\n  }\n}\n\n/**\n * 原生中文无法显示 使用https://gero3.github.io/facetype.js/ 将.tff 格式的文字转为 .json 格式\n */\nfunction createText(options) {\n  let { x, y, z, name } = options;\n  const loader = new FontLoader();\n  loader.load(\"/fonts/STSong_Regular.json\", (font) => {\n    let fontGeometry = new TextGeometry(name, {\n      size: 8, //字号大小，一般为大写字母的高度\n      height: 2, //文字的厚度\n      weight: \"normal\", //值为'normal'或'bold'，表示是否加粗\n      font: font, //字体，默认是'helvetiker'，需对应引用的字体文件\n      style: \"normal\", //值为'normal'或'italics'，表示是否斜体\n      bevelThickness: 1, //倒角厚度\n      bevelSize: 1, //倒角宽度\n      curveSegments: 30, //弧线分段数，使得文字的曲线更加光滑\n      bevelEnabled: true, //布尔值，是否使用倒角，意为在边缘处斜切\n    });\n    fontGeometry.computeBoundingBox(); //绑定盒子模型\n    // 文字的材质\n    /*    let fontMaterial = new THREE.MeshNormalMaterial({\n      flatShading: THREE.FlatShading,\n      transparent: true,\n      opacity: 0.9,\n    });*/\n    // let fontMaterial = new THREE.MeshBasicMaterial({ color: 0xa5e5e9 });\n    let fontMaterial = new THREE.MeshBasicMaterial({ color: 0x54afe8 });\n    let fonts = new THREE.Mesh(fontGeometry, fontMaterial);\n    // 计算出整个模型宽度的一半, 不然模型就会绕着x = 0,中心旋转\n    /*    fonts.position.x =\n      -(fontGeometry.boundingBox.max.x - fontGeometry.boundingBox.min.x) / 2;*/\n    fonts.position.set(x - 18, y, z);\n    data.base3D.scene.add(fonts);\n  });\n}\n</script>\n\n<style scoped>\n.title {\n  position: absolute;\n  padding: 2px 10px;\n  /*background: rgba(255, 255, 255, 0.5);*/\n  line-height: 1;\n  border-radius: 5px;\n}\n.label img {\n  /*background: url(\"public/images/label.png\") no-repeat 100%;*/\n  width: 100%;\n  height: 100%;\n}\n\n.label p {\n  font-size: 20px;\n  color: #ffdd77;\n  padding: 10px 29px;\n  position: absolute;\n  top: 0;\n  margin: 0;\n}\n#sceneContainer {\n  width: 100%;\n  height: 100%;\n}\n\n#del {\n  position: absolute;\n  top: 50px;\n}\n\n.pass_button {\n  position: fixed;\n  top: 60px;\n  left: 4px;\n  height: 30px;\n  width: 64px;\n  outline: none;\n  border: none;\n  -webkit-appearance: none;\n  background: rgba(0, 0, 0, 0.4);\n  box-shadow: 0 1px 4px rgba(0, 0, 0, 0.25);\n  border-radius: 4px;\n  color: rgba(255, 255, 255, 0.6);\n  font-size: 12px;\n}\n.highlight {\n  color: rgba(255, 255, 0, 0.6);\n}\n\n.phaseOf {\n  position: fixed;\n  top: 100px;\n  left: 4px;\n  width: 43px;\n  height: 130px;\n}\n.phaseOf .phaseOf_c {\n  margin: 4px 0;\n}\n</style>\n"],"names":["THREE.Vector2","THREE.Raycaster","THREE.Group","THREE.MeshBasicMaterial","THREE.Mesh"],"mappings":"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"}