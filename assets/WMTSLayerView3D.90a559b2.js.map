{"version":3,"file":"WMTSLayerView3D.90a559b2.js","sources":["../../node_modules/@arcgis/core/views/3d/layers/WMTSLayerView3D.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import t from\"../../../core/Error.js\";import i from\"../../../core/Logger.js\";import{whenTrueOnce as r}from\"../../../core/watchUtils.js\";import{property as s}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/arrayUtils.js\";import\"../../../core/has.js\";import\"../../../core/accessorSupport/ensureType.js\";import{subclass as o}from\"../../../core/accessorSupport/decorators/subclass.js\";import{LayerView3D as a}from\"./LayerView3D.js\";import{TiledLayerView3D as l}from\"./TiledLayerView3D.js\";import n from\"../../layers/LayerView.js\";import{RefreshableLayerView as h}from\"../../layers/RefreshableLayerView.js\";const p=i.getLogger(\"esri.views.3d.layers.WMTSLayerView3d\");let c=class extends(h(l(a(n)))){constructor(){super(...arguments),this.type=\"wmts-3d\"}get hasMixedImageFormats(){return!0}initialize(){const e=r(this.view,\"basemapTerrain.tilingSchemeDone\").then((()=>{const e=()=>new t(\"layerview:no-compatible-tiling-scheme\",\"None of the tiling schemes supported by the service are compatible with the scene.\");if(!this.view.basemapTerrain.tilingSchemeLocked)throw e();const i=this.view.basemapTerrain.tilingScheme,r=this.layer.activeLayer;let s;if(r&&r.tileMatrixSet){s=r.tileMatrixSet;const e=s.tileInfo,t=this._getTileInfoSupportError(e,s.fullExtent)||this._getTileInfoCompatibilityError(e,i);if(t)throw t}else{if(s=this._getCompatibleTileMatrixSet(),!s)throw e();r.tileMatrixSetId=s.id}this._set(\"tileInfo\",s.tileInfo),this._set(\"fullExtent\",s.fullExtent),this.layer.fullExtent=s.fullExtent}));this.addResolvingPromise(e),this.when((()=>this._initialized()))}refresh(){this.emit(\"data-changed\")}canResume(){if(!super.canResume())return!1;const e=this.layer.activeLayer.tileMatrixSet;return e&&!this._getTileInfoError(e.tileInfo,e.fullExtent)}async doRefresh(){this.suspended||this.emit(\"data-changed\")}_initialized(){this.updatingHandles.add(this,\"layer.activeLayer.styleId\",(()=>this.refresh())),this.updatingHandles.add(this,\"tileMatrixSet\",(()=>this.refresh())),this.updatingHandles.add(this.layer,\"activeLayer\",(e=>{let t=e.tileMatrixSet;if(t){const e=this._getTileInfoError(t.tileInfo,t.fullExtent);e&&(p.error(\"The selected tile matrix set is not compatible with the view\",e),t=null)}else t=this._getCompatibleTileMatrixSet(),t?e.tileMatrixSetId=t.id:p.error(\"The layer does not provide a tiling scheme that is compatible with the view\");this.notifyChange(\"suspended\"),this.canResume()&&this.refresh()}))}_getCompatibleTileMatrixSet(){return this.layer.activeLayer.tileMatrixSets.find((e=>{const t=e.tileInfo;return!this._getTileInfoError(t,e.fullExtent)}))}_getTileInfoError(e,t){return this._getTileInfoSupportError(e,t)||this._getTileInfoCompatibilityError(e,this.view.basemapTerrain.tilingScheme)}};e([s({readOnly:!0})],c.prototype,\"hasMixedImageFormats\",null),e([s()],c.prototype,\"fullExtent\",void 0),e([s()],c.prototype,\"layer\",void 0),e([s()],c.prototype,\"suspended\",void 0),e([s()],c.prototype,\"tileInfo\",void 0),c=e([o(\"esri.views.3d.layers.WMTSLayerView3D\")],c);const m=c;export{m as default};\n"],"names":["i","h","l","a","n","r","t","s","o"],"mappings":"uKAI2qB,KAAM,GAAEA,EAAE,UAAU,wCAAwC,GAAI,GAAE,aAAcC,GAAEC,EAAEC,EAAEC,IAAK,CAAC,aAAa,CAAC,MAAM,GAAG,WAAW,KAAK,KAAK,aAAc,uBAAsB,CAAC,MAAM,GAAG,YAAY,CAAC,KAAM,GAAEC,EAAE,KAAK,KAAK,mCAAmC,KAAM,IAAI,CAAC,KAAM,GAAE,IAAI,GAAIC,GAAE,wCAAwC,sFAAsF,GAAG,CAAC,KAAK,KAAK,eAAe,mBAAmB,KAAM,KAAI,KAAM,GAAE,KAAK,KAAK,eAAe,aAAa,EAAE,KAAK,MAAM,YAAY,GAAI,GAAE,GAAG,GAAG,EAAE,cAAc,CAAC,EAAE,EAAE,cAAc,KAAM,GAAE,EAAE,SAAS,EAAE,KAAK,yBAAyB,EAAE,EAAE,aAAa,KAAK,+BAA+B,EAAE,GAAG,GAAG,EAAE,KAAM,OAAM,CAAC,GAAG,EAAE,KAAK,8BAA8B,CAAC,EAAE,KAAM,KAAI,EAAE,gBAAgB,EAAE,GAAG,KAAK,KAAK,WAAW,EAAE,UAAU,KAAK,KAAK,aAAa,EAAE,YAAY,KAAK,MAAM,WAAW,EAAE,aAAc,KAAK,oBAAoB,GAAG,KAAK,KAAM,IAAI,KAAK,gBAAiB,SAAS,CAAC,KAAK,KAAK,gBAAgB,WAAW,CAAC,GAAG,CAAC,MAAM,YAAY,MAAM,GAAG,KAAM,GAAE,KAAK,MAAM,YAAY,cAAc,MAAO,IAAG,CAAC,KAAK,kBAAkB,EAAE,SAAS,EAAE,iBAAkB,YAAW,CAAC,KAAK,WAAW,KAAK,KAAK,gBAAgB,cAAc,CAAC,KAAK,gBAAgB,IAAI,KAAK,4BAA6B,IAAI,KAAK,WAAY,KAAK,gBAAgB,IAAI,KAAK,gBAAiB,IAAI,KAAK,WAAY,KAAK,gBAAgB,IAAI,KAAK,MAAM,cAAe,GAAG,CAAC,GAAI,GAAE,EAAE,cAAc,GAAG,EAAE,CAAC,KAAM,GAAE,KAAK,kBAAkB,EAAE,SAAS,EAAE,YAAY,GAAI,GAAE,MAAM,+DAA+D,GAAG,EAAE,UAAW,GAAE,KAAK,8BAA8B,EAAE,EAAE,gBAAgB,EAAE,GAAG,EAAE,MAAM,+EAA+E,KAAK,aAAa,aAAa,KAAK,aAAa,KAAK,YAAa,6BAA6B,CAAC,MAAO,MAAK,MAAM,YAAY,eAAe,KAAM,GAAG,CAAC,KAAM,GAAE,EAAE,SAAS,MAAM,CAAC,KAAK,kBAAkB,EAAE,EAAE,cAAe,kBAAkB,EAAE,EAAE,CAAC,MAAO,MAAK,yBAAyB,EAAE,IAAI,KAAK,+BAA+B,EAAE,KAAK,KAAK,eAAe,gBAAgB,EAAE,CAACC,EAAE,CAAC,SAAS,MAAM,EAAE,UAAU,uBAAuB,MAAM,EAAE,CAACA,KAAK,EAAE,UAAU,aAAa,QAAQ,EAAE,CAACA,KAAK,EAAE,UAAU,QAAQ,QAAQ,EAAE,CAACA,KAAK,EAAE,UAAU,YAAY,QAAQ,EAAE,CAACA,KAAK,EAAE,UAAU,WAAW,QAAQ,EAAE,EAAE,CAACC,EAAE,yCAAyC,GAAQ,KAAC,GAAE"}