import{bz as D,k2 as N,i6 as U,dY as H,jg as J,k3 as V,k4 as z,D as p,E as g,J as Q,L as W,bC as L,hm as K,jm as B,k5 as X,g$ as Z,e0 as I,dG as m,e3 as P,k6 as h,k7 as tt,dH as nt,dF as _,ew as et,k8 as d,ci as rt,k9 as at,ka as ot,kb as it,c0 as st,m as T,kc as lt,kd as ct,jy as F,ke as ut,kf as q,U as f,kg as k,kh as y,ki as pt,kj as gt,dQ as ft,kk as ht,bu as yt,iI as mt,e2 as $t,kl as At,km as dt,kn as kt,ko as xt,kp as wt,kq as vt}from"./externalRenderers.e9b2a64d.js";function $(t=Ft){return[t[0],t[1],t[2],t[3]]}function Yt(t,e,n=$()){return D(A(n),t),n[3]=e,n}function Gt(t,e,n=$()){return N(x,A(t),M(t)),N(O,A(e),M(e)),H(x,O,x),Tt(n,J(V(A(n),x)))}function A(t){return t}function M(t){return U(t[3])}function Tt(t,e){return t[3]=e,t}const Ft=[0,0,1,0],x=z(),O=z();$();var b;let u=b=class extends W{constructor(t){super(t),this.origin=L(),this.translation=L(),this.rotation=$(),this.scale=K(1,1,1),this.geographic=!0}get localMatrix(){const t=m();return B(t,t,this.scale),X(t,t,M(this.rotation),A(this.rotation)),Z(t,t,this.translation),t}get localMatrixInverse(){return I(m(),this.localMatrix)}applyLocal(t,e){return P(e,t,this.localMatrix)}applyLocalInverse(t,e){return P(e,t,this.localMatrixInverse)}project(t,e){const n=new Float64Array(t.length),r=h.fromTypedArray(n),a=h.fromTypedArray(t);if(this.geographic){const s=tt(nt(e)),c=m();return _(e,this.origin,c,s),et(c,c,this.localMatrix),d(r,a,c),rt(n,s,0,n,e,0,n.length/3),n}const{localMatrix:o,origin:i}=this;at(o,ot)?it(r,a):d(r,a,o);for(let s=0;s<n.length;s+=3)n[s+0]+=i[0],n[s+1]+=i[1],n[s+2]+=i[2];return n}getOriginPoint(t){const[e,n,r]=this.origin;return new st({x:e,y:n,z:r,spatialReference:t})}equals(t){return T(t)&&this.geographic===t.geographic&&lt(this.origin,t.origin)&&ct(this.localMatrix,t.localMatrix)}clone(){const t={origin:F(this.origin),translation:F(this.translation),rotation:$(this.rotation),scale:F(this.scale),geographic:this.geographic};return new b(t)}};p([g({type:[Number],nonNullable:!0,json:{write:!0}})],u.prototype,"origin",void 0),p([g({type:[Number],nonNullable:!0,json:{write:!0}})],u.prototype,"translation",void 0),p([g({type:[Number],nonNullable:!0,json:{write:!0}})],u.prototype,"rotation",void 0),p([g({type:[Number],nonNullable:!0,json:{write:!0}})],u.prototype,"scale",void 0),p([g({type:Boolean,nonNullable:!0,json:{write:!0}})],u.prototype,"geographic",void 0),p([g()],u.prototype,"localMatrix",null),p([g()],u.prototype,"localMatrixInverse",null),u=b=p([Q("esri.geometry.support.MeshTransform")],u);const Mt=u;function w(t,e){var n;return t.isGeographic||t.isWebMercator&&((n=e==null?void 0:e.geographic)==null||n)}function Y(t,e,n){return w(e.spatialReference,n)?jt(t,e,n):Et(t,e,n)}function bt(t,e,n){const{position:r,normal:a,tangent:o}=t;if(f(e))return{position:r,normal:a,tangent:o};const i=e.localMatrix;return Y({position:xt(r,new Float64Array(r.length),i),normal:T(a)?wt(a,new Float32Array(a.length),i):null,tangent:T(o)?vt(o,new Float32Array(o.length),i):null},e.getOriginPoint(n),{geographic:e.geographic})}function Ct(t,e,n){if(n!=null&&n.useTransform){var r;const{position:a,normal:o,tangent:i}=t;return{vertexAttributes:{position:a,normal:o,tangent:i},transform:new Mt({origin:[e.x,e.y,(r=e.z)!=null?r:0],geographic:w(e.spatialReference,n)})}}return{vertexAttributes:Y(t,e,n),transform:null}}function Rt(t,e,n){return w(e.spatialReference,n)?G(t,e,n):R(t,e,n)}function St(t,e,n,r){if(f(e))return Rt(t,n,r);const a=bt(t,e,n.spatialReference);return n.equals(e.getOriginPoint(n.spatialReference))?R(a,n,r):w(n.spatialReference,r)?G(a,n,r):R(a,n,r)}function Et(t,e,n){const r=new Float64Array(t.position.length),a=t.position,o=e.x,i=e.y,s=e.z||0,{horizontal:c,vertical:v}=E(n?n.unit:null,e.spatialReference);for(let l=0;l<a.length;l+=3)r[l+0]=a[l+0]*c+o,r[l+1]=a[l+1]*c+i,r[l+2]=a[l+2]*v+s;return{position:r,normal:t.normal,tangent:t.tangent}}function jt(t,e,n){const r=e.spatialReference,a=C(e,n,j),o=new Float64Array(t.position.length),i=Nt(t.position,a,r,o),s=q(S,a);return{position:i,normal:zt(i,o,t.normal,s,r),tangent:Lt(i,o,t.tangent,s,r)}}function Nt(t,e,n,r){d(h.fromTypedArray(r),h.fromTypedArray(t),e);const a=new Float64Array(t.length);return ut(r,a,n)}function zt(t,e,n,r,a){if(f(n))return null;const o=new Float32Array(n.length);return k(y.fromTypedArray(o),y.fromTypedArray(n),r),pt(o,t,e,a,o),o}function Lt(t,e,n,r,a){if(f(n))return null;const o=new Float32Array(n.length);k(y.fromTypedArray(o,4*Float32Array.BYTES_PER_ELEMENT),y.fromTypedArray(n,4*Float32Array.BYTES_PER_ELEMENT),r);for(let i=3;i<o.length;i+=4)o[i]=n[i];return gt(o,t,e,a,o),o}function R(t,e,n){const r=new Float64Array(t.position.length),a=t.position,o=e.x,i=e.y,s=e.z||0,{horizontal:c,vertical:v}=E(n?n.unit:null,e.spatialReference);for(let l=0;l<a.length;l+=3)r[l+0]=(a[l+0]-o)/c,r[l+1]=(a[l+1]-i)/c,r[l+2]=(a[l+2]-s)/v;return{position:r,normal:t.normal,tangent:t.tangent}}function G(t,e,n){const r=e.spatialReference;C(e,n,j);const a=I(_t,j),o=new Float64Array(t.position.length),i=Bt(t.position,r,a,o),s=q(S,a);return{position:i,normal:It(t.normal,t.position,o,r,s),tangent:Pt(t.tangent,t.position,o,r,s)}}function C(t,e,n){_(t.spatialReference,[t.x,t.y,t.z||0],n,ft(t.spatialReference));const{horizontal:r,vertical:a}=E(e?e.unit:null,t.spatialReference);return B(n,n,[r,r,a]),n}function Bt(t,e,n,r){const a=At(t,e,r),o=h.fromTypedArray(a),i=new Float64Array(a.length),s=h.fromTypedArray(i);return d(s,o,n),i}function It(t,e,n,r,a){if(f(t))return null;const o=dt(t,e,n,r,new Float32Array(t.length)),i=y.fromTypedArray(o);return k(i,i,a),o}function Pt(t,e,n,r,a){if(f(t))return null;const o=kt(t,e,n,r,new Float32Array(t.length)),i=y.fromTypedArray(o,4*Float32Array.BYTES_PER_ELEMENT);return k(i,i,a),o}function E(t,e){if(f(t))return qt;const n=e.isGeographic?1:ht(e),r=e.isGeographic?1:yt(e),a=mt(1,t,"meters");return{horizontal:a*n,vertical:a*r}}const j=m(),_t=m(),S=$t(),qt={horizontal:1,vertical:1};export{St as M,Mt as O,bt as _,$ as a,Ct as b,M as c,Yt as d,Rt as k,A as l,Gt as q,w as r,Y as x};
//# sourceMappingURL=georeference.f998972b.js.map
