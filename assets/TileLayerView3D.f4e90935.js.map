{"version":3,"file":"TileLayerView3D.f4e90935.js","sources":["../../node_modules/@arcgis/core/views/layers/TileLayerView.js","../../node_modules/@arcgis/core/views/3d/layers/TileLayerView3D.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import r from\"../../core/Error.js\";import{isSome as t}from\"../../core/maybe.js\";import{eachAlways as o}from\"../../core/promiseUtils.js\";import{property as s}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/arrayUtils.js\";import\"../../core/has.js\";import\"../../core/accessorSupport/ensureType.js\";import{subclass as a}from\"../../core/accessorSupport/decorators/subclass.js\";import{calculateTolerance as p}from\"../../renderers/support/clickToleranceUtils.js\";const i=i=>{let c=class extends i{async fetchPopupFeatures(e,s){const{layer:a}=this;if(!e)return Promise.reject(new r(\"tilelayerview:fetchPopupFeatures\",\"Nothing to fetch without area\",{layer:a}));if(\"tile\"!==a.type)return Promise.reject(new r(\"tilelayerview:fetchPopupFeatures\",\"Layer type should be 'tile'\",{type:a.type}));const i=this.get(\"view.scale\"),c=a.allSublayers.toArray().filter((e=>{const r=0===e.minScale||i<=e.minScale,t=0===e.maxScale||i>=e.maxScale;return e.popupTemplate&&e.popupEnabled&&e.visible&&r&&t}));return o(c.map((async r=>{const o=r.createQuery(),a=t(s)?s.event:null,i=p({renderer:r.renderer,event:a});o.geometry=this.createFetchPopupFeaturesQueryGeometry(e,i),o.outFields=await r.popupTemplate.getRequiredFields();return(await r.queryFeatures(o)).features}))).then((e=>[].concat(...e.map((e=>e.value)).filter(Boolean))))}};return e([s()],c.prototype,\"layer\",void 0),c=e([a(\"esri.layers.mixins.TileLayerView\")],c),c};export{i as TileLayerView,i as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import r from\"../../../core/Error.js\";import{isNone as t}from\"../../../core/maybe.js\";import{property as i}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/arrayUtils.js\";import\"../../../core/has.js\";import\"../../../core/accessorSupport/ensureType.js\";import{subclass as o}from\"../../../core/accessorSupport/decorators/subclass.js\";import{canProjectWithoutEngine as s}from\"../../../geometry/projection.js\";import{LayerView3D as a}from\"./LayerView3D.js\";import{TiledLayerView3D as l}from\"./TiledLayerView3D.js\";import n from\"../../layers/LayerView.js\";import{RefreshableLayerView as p}from\"../../layers/RefreshableLayerView.js\";import{TileLayerView as m}from\"../../layers/TileLayerView.js\";import{createQueryGeometry as f}from\"../../support/drapedUtils.js\";let c=class extends(p(l(m(a(n))))){constructor(){super(...arguments),this.type=\"tile-3d\"}get imageFormatIsOpaque(){return\"jpg\"===this.layer.tileInfo.format}get hasMixedImageFormats(){return\"mixed\"===this.layer.tileInfo.format}get dataLevelRange(){if(this.tileInfo){const e=this.tileInfo.lods,r=e[0].scale,t=e[e.length-1].scale;return this.levelRangeFromScaleRange(r,t)}return{minLevel:0,maxLevel:0}}initialize(){if(\"web-tile\"===this.layer.type){const e=this.layer.get(\"fullExtent.spatialReference\"),i=this.layer.get(\"tileInfo.spatialReference\");if(t(e)||t(i)||!s(e,i)){const e=\"defaults\"===this.layer.originOf(\"fullExtent\")||t(this.layer.fullExtent)?\"SceneView requires fullExtent to be specified by the user on WebTileLayer\":\"SceneView requires fullExtent to be specified in the same spatial reference as tileInfo on WebTileLayer\";this.addResolvingPromise(Promise.reject(new r(\"layerview:incompatible-fullextent\",e)))}}this._addTilingSchemeMatchPromise()}createFetchPopupFeaturesQueryGeometry(e,r){return f(e,r,this.view)}async doRefresh(){this.suspended||this.emit(\"data-changed\")}};e([i({readOnly:!0})],c.prototype,\"imageFormatIsOpaque\",null),e([i({readOnly:!0})],c.prototype,\"hasMixedImageFormats\",null),e([i({aliasOf:\"layer.fullExtent\"})],c.prototype,\"fullExtent\",void 0),e([i()],c.prototype,\"layer\",void 0),e([i({aliasOf:\"layer.tileInfo\"})],c.prototype,\"tileInfo\",void 0),e([i({readOnly:!0})],c.prototype,\"dataLevelRange\",null),c=e([o(\"esri.views.3d.layers.TileLayerView3D\")],c);const y=c;export{y as default};\n"],"names":["s","r","o","t","p","a","l","m","n","f","i"],"mappings":"0RAIghB,KAAM,GAAE,GAAG,CAAC,GAAI,GAAE,aAAc,EAAC,MAAO,oBAAmB,EAAEA,EAAE,CAAC,KAAK,CAAC,MAAM,GAAG,KAAK,GAAG,CAAC,EAAE,MAAO,SAAQ,OAAO,GAAIC,GAAE,mCAAmC,gCAAgC,CAAC,MAAM,KAAK,GAAG,AAAS,EAAE,OAAX,OAAgB,MAAO,SAAQ,OAAO,GAAIA,GAAE,mCAAmC,8BAA8B,CAAC,KAAK,EAAE,QAAQ,KAAM,GAAE,KAAK,IAAI,cAAc,EAAE,EAAE,aAAa,UAAU,OAAQ,GAAG,CAAC,KAAM,GAAE,AAAI,EAAE,WAAN,GAAgB,GAAG,EAAE,SAAS,EAAE,AAAI,EAAE,WAAN,GAAgB,GAAG,EAAE,SAAS,MAAO,GAAE,eAAe,EAAE,cAAc,EAAE,SAAS,GAAG,IAAK,MAAOC,GAAE,EAAE,IAAK,KAAMD,IAAG,CAAC,KAAM,GAAEA,EAAE,cAAc,EAAEE,EAAEH,GAAGA,EAAE,MAAM,KAAK,EAAEI,EAAE,CAAC,SAASH,EAAE,SAAS,MAAM,IAAI,SAAE,SAAS,KAAK,sCAAsC,EAAE,GAAG,EAAE,UAAU,KAAMA,GAAE,cAAc,oBAA2B,MAAMA,GAAE,cAAc,IAAI,YAAa,KAAM,GAAG,GAAG,OAAO,GAAG,EAAE,IAAK,GAAG,EAAE,OAAQ,OAAO,aAAc,MAAO,GAAE,CAACD,KAAK,EAAE,UAAU,QAAQ,QAAQ,EAAE,EAAE,CAACK,EAAE,qCAAqC,GAAG,GCAznB,GAAI,GAAE,aAAcD,GAAEE,EAAEC,EAAEF,EAAEG,KAAM,CAAC,aAAa,CAAC,MAAM,GAAG,WAAW,KAAK,KAAK,aAAc,sBAAqB,CAAC,MAAM,AAAQ,MAAK,MAAM,SAAS,SAA5B,SAAuC,uBAAsB,CAAC,MAAM,AAAU,MAAK,MAAM,SAAS,SAA9B,WAAyC,iBAAgB,CAAC,GAAG,KAAK,SAAS,CAAC,KAAM,GAAE,KAAK,SAAS,KAAK,EAAE,EAAE,GAAG,MAAM,EAAE,EAAE,EAAE,OAAO,GAAG,MAAM,MAAO,MAAK,yBAAyB,EAAE,GAAG,MAAM,CAAC,SAAS,EAAE,SAAS,GAAG,YAAY,CAAC,GAAG,AAAa,KAAK,MAAM,OAAxB,WAA6B,CAAC,KAAM,GAAE,KAAK,MAAM,IAAI,+BAA+B,EAAE,KAAK,MAAM,IAAI,6BAA6B,GAAG,EAAE,IAAI,EAAE,IAAI,CAACR,EAAE,EAAE,GAAG,CAAC,KAAM,GAAE,AAAa,KAAK,MAAM,SAAS,gBAAjC,YAAgD,EAAE,KAAK,MAAM,YAAY,4EAA4E,0GAA0G,KAAK,oBAAoB,QAAQ,OAAO,GAAIC,GAAE,oCAAoC,MAAM,KAAK,+BAA+B,sCAAsC,EAAE,EAAE,CAAC,MAAOQ,GAAE,EAAE,EAAE,KAAK,WAAY,YAAW,CAAC,KAAK,WAAW,KAAK,KAAK,kBAAkB,EAAE,CAACC,EAAE,CAAC,SAAS,MAAM,EAAE,UAAU,sBAAsB,MAAM,EAAE,CAACA,EAAE,CAAC,SAAS,MAAM,EAAE,UAAU,uBAAuB,MAAM,EAAE,CAACA,EAAE,CAAC,QAAQ,sBAAsB,EAAE,UAAU,aAAa,QAAQ,EAAE,CAACA,KAAK,EAAE,UAAU,QAAQ,QAAQ,EAAE,CAACA,EAAE,CAAC,QAAQ,oBAAoB,EAAE,UAAU,WAAW,QAAQ,EAAE,CAACA,EAAE,CAAC,SAAS,MAAM,EAAE,UAAU,iBAAiB,MAAM,EAAE,EAAE,CAACR,EAAE,yCAAyC,GAAQ,KAAC,GAAE"}