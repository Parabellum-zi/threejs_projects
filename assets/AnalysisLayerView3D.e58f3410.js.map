{"version":3,"file":"AnalysisLayerView3D.e58f3410.js","sources":["../../node_modules/@arcgis/core/views/3d/layers/AnalysisLayerView3D.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import s from\"../../../core/Collection.js\";import\"../../../core/has.js\";import i from\"../../../core/Error.js\";import{isSome as a,isNone as t}from\"../../../core/maybe.js\";import{createTask as r,isAborted as n}from\"../../../core/promiseUtils.js\";import{property as o}from\"../../../core/accessorSupport/decorators/property.js\";import{subclass as l}from\"../../../core/accessorSupport/decorators/subclass.js\";import{LayerView3D as y}from\"./LayerView3D.js\";import c from\"../../layers/LayerView.js\";const m=\"analysis-view-handles\";let w=class extends(y(c)){constructor(e){super(e),this.type=\"analysis-3d\",this.allAnalysisViews=new s,this._creatingViewCount=0,this._analysisViewCreationTasks=new Map,this._analysisModules={\"area-measurement\":{module:null},\"direct-line-measurement\":{module:null},\"line-of-sight\":{module:null},slice:{module:null}}}initialize(){for(const e of this.layer.analyses)this._createAnalysisView(e);this.handles.add([this.layer.analyses.on(\"after-add\",(e=>{this._createAnalysisView(e.item)})),this.layer.analyses.on(\"after-remove\",(e=>{const s=this.allAnalysisViews.removeAt(this.allAnalysisViews.findIndex((s=>s.analysis===e.item)));a(s)&&s.destroy();const i=this._analysisViewCreationTasks.get(e.item);a(i)&&(i.abort(),this._analysisViewCreationTasks.delete(e.item))}))],m)}destroy(){this.handles.remove(m),this.allAnalysisViews.drain((e=>e.destroy())),this._analysisViewCreationTasks.clear(),this._creatingViewCount=0}whenAnalysisView(e){const s=this._analysisViewCreationTasks.get(e);if(a(s))return s.promise;const t=new i(\"layerview:no-analysisview-for-analysis\",\"The analysis has not been added to the AnalysisLayer of this layer view\",{analysis:e});return Promise.reject(t)}isUpdating(){return 0!==this._creatingViewCount||this.allAnalysisViews.some((e=>e.updating))}_createAnalysisView(e){this._analysisViewCreationTasks.set(e,r((s=>this._createAnalysisViewPromise(e,s))))}async _createAnalysisViewPromise(e,s){this._creatingViewCount+=1;const a=e.type,r=this._analysisModules[a];if(t(r.module)){const e=await this._loadAnalysisModule(a);r.module=e}const o=new r.module.default({analysis:e,view:this.view,parent:this});if(await o.when(),this._creatingViewCount-=1,n(s))throw o.destroy(),new i(\"layerview:no-analysisview-for-analysis\",\"The analysis has not been added to the AnalysisLayer of this layer view\",{analysis:e});return this.allAnalysisViews.add(o),o}_loadAnalysisModule(e){switch(e){case\"area-measurement\":return import(\"../analysis/AreaMeasurement/AreaMeasurementView3D.js\");case\"direct-line-measurement\":return import(\"../analysis/DirectLineMeasurement/DirectLineMeasurementView3D.js\");case\"line-of-sight\":return import(\"../analysis/LineOfSight/LineOfSightView3D.js\");case\"slice\":return import(\"../analysis/Slice/SliceView3D.js\");default:return null}}};e([o()],w.prototype,\"type\",void 0),e([o()],w.prototype,\"layer\",void 0),e([o()],w.prototype,\"allAnalysisViews\",void 0),e([o()],w.prototype,\"_creatingViewCount\",void 0),w=e([l(\"esri.views.3d.layers.AnalysisLayerView3D\")],w);const d=w;export{d as default};\n"],"names":["y","c","s","a","i","r","n","o","l"],"mappings":"+HAI6hB,KAAM,GAAE,wBAAwB,GAAI,GAAE,aAAcA,GAAEC,EAAG,CAAC,YAAY,EAAE,CAAC,MAAM,GAAG,KAAK,KAAK,cAAc,KAAK,iBAAiB,GAAIC,GAAE,KAAK,mBAAmB,EAAE,KAAK,2BAA2B,GAAI,KAAI,KAAK,iBAAiB,CAAC,mBAAmB,CAAC,OAAO,MAAM,0BAA0B,CAAC,OAAO,MAAM,gBAAgB,CAAC,OAAO,MAAM,MAAM,CAAC,OAAO,OAAO,YAAY,CAAC,SAAU,KAAK,MAAK,MAAM,SAAS,KAAK,oBAAoB,GAAG,KAAK,QAAQ,IAAI,CAAC,KAAK,MAAM,SAAS,GAAG,YAAa,GAAG,CAAC,KAAK,oBAAoB,EAAE,QAAS,KAAK,MAAM,SAAS,GAAG,eAAgB,GAAG,CAAC,KAAM,GAAE,KAAK,iBAAiB,SAAS,KAAK,iBAAiB,UAAW,GAAG,EAAE,WAAW,EAAE,OAAQC,EAAE,IAAI,EAAE,UAAU,KAAM,GAAE,KAAK,2BAA2B,IAAI,EAAE,MAAMA,EAAE,IAAK,GAAE,QAAQ,KAAK,2BAA2B,OAAO,EAAE,UAAW,GAAG,SAAS,CAAC,KAAK,QAAQ,OAAO,GAAG,KAAK,iBAAiB,MAAO,GAAG,EAAE,WAAY,KAAK,2BAA2B,QAAQ,KAAK,mBAAmB,EAAE,iBAAiB,EAAE,CAAC,KAAMD,GAAE,KAAK,2BAA2B,IAAI,GAAG,GAAGC,EAAED,GAAG,MAAOA,GAAE,QAAQ,KAAM,GAAE,GAAIE,GAAE,yCAAyC,0EAA0E,CAAC,SAAS,IAAI,MAAO,SAAQ,OAAO,GAAG,YAAY,CAAC,MAAO,AAAI,MAAK,qBAAT,GAA6B,KAAK,iBAAiB,KAAM,GAAG,EAAE,UAAW,oBAAoB,EAAE,CAAC,KAAK,2BAA2B,IAAI,EAAEC,EAAG,GAAG,KAAK,2BAA2B,EAAE,UAAY,4BAA2B,EAAEH,EAAE,CAAC,KAAK,oBAAoB,EAAE,KAAM,GAAE,EAAE,KAAK,EAAE,KAAK,iBAAiB,GAAG,GAAG,EAAE,EAAE,QAAQ,CAAC,KAAM,GAAE,KAAM,MAAK,oBAAoB,GAAG,EAAE,OAAO,EAAE,KAAM,GAAE,GAAI,GAAE,OAAO,QAAQ,CAAC,SAAS,EAAE,KAAK,KAAK,KAAK,OAAO,OAAO,GAAG,KAAM,GAAE,OAAO,KAAK,oBAAoB,EAAEI,EAAEJ,GAAG,KAAM,GAAE,UAAU,GAAIE,GAAE,yCAAyC,0EAA0E,CAAC,SAAS,IAAI,MAAO,MAAK,iBAAiB,IAAI,GAAG,EAAE,oBAAoB,EAAE,CAAC,OAAO,OAAO,mBAAmB,MAAO,QAAO,yEAA4D,0BAA0B,MAAO,QAAO,+EAAwE,gBAAgB,MAAO,QAAO,uCAAoD,QAAQ,MAAO,QAAO,mEAA4C,MAAO,SAAQ,EAAE,CAACG,KAAK,EAAE,UAAU,OAAO,QAAQ,EAAE,CAACA,KAAK,EAAE,UAAU,QAAQ,QAAQ,EAAE,CAACA,KAAK,EAAE,UAAU,mBAAmB,QAAQ,EAAE,CAACA,KAAK,EAAE,UAAU,qBAAqB,QAAQ,EAAE,EAAE,CAACC,EAAE,6CAA6C,GAAQ,KAAC,GAAE"}