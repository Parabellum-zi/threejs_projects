import{ref as W,reactive as q,onBeforeMount as E,onMounted as z,openBlock as N,createElementBlock as k}from"vue";import{W as U,S as F,P as O,aD as V,a as H,V as P,m as J,n as K,T as Q,R as A,o as Z,D as $,c as B}from"./three.module.3b505d30.js";import{r as ee,x as ae,j as te,s as re,a as ne,b as oe,u as se}from"./externalRenderers.e9b2a64d.js";import ie from"./TileLayer.e8f4ccfe.js";import he from"./SceneLayer.40926399.js";import{_ as pe}from"./index.f0707c98.js";import"./ArcGISCachedService.fa9643d7.js";import"./TilemapCache.f41a8639.js";import"./SublayersOwner.a1e4d946.js";import"./floorFilterUtils.1acb5b5d.js";import"./sublayerUtils.5227ee88.js";import"./SceneService.ec13f327.js";import"./multiOriginJSONSupportUtils.f4e66410.js";import"./I3SIndexInfo.becbd491.js";import"./resourceUtils.c5a9d9b8.js";import"./capabilities.2e888fa1.js";import"./FetchAssociatedFeatureLayer.8646279d.js";import"./I3SLayerDefinitions.772a0235.js";import"./vendor.c70270c6.js";var f=f||{};f.GaussTransform={ellip_CGCS200:{a:6378137,b:635675231414e-5,f:1/298.257222101},ProjectionPara:{CenterL:113.2833333333,ZoneWide:3,ZoneNo:38},fourTransPra:{scale:.999997756396785,rotationAngle:.0044099861111111,DX:-199995.893159972,DY:-16.6491077492992},BL2XY:function(a,i,t,e){var t=t||f.GaussTransform.ellip_CGCS200,e=e||f.GaussTransform.ProjectionPara,p=t.a?t.a:0;t.b&&t.b;var d=t.f?t.f:0,w=e.ZoneWide?e.ZoneWide:3,v=e.ZoneNo?e.ZoneNo:parseInt(i/w)+1,n=e.CenterL?e.CenterL:v*w-w/2,m=Math.sqrt(2*d-Math.pow(d,2)),T=m/Math.sqrt(1-m*m);a=f.AngleTransform.Degree2Radian(a,!1),i=f.AngleTransform.Degree2Radian(i,!1);var l=Math.pow(T,2)*Math.pow(Math.cos(a),2),r=Math.tan(a),s=Math.sqrt(1-Math.pow(m*Math.sin(a),2)),o=p/s,u=i-f.AngleTransform.Degree2Radian(n,!1),h=Math.pow(u,2),M=p*(1-Math.pow(m,2))*(1.00505250559297*a-.00253155620900066*Math.sin(2*a)+265690155540381e-20*Math.sin(4*a)-347007559905787e-23*Math.sin(6*a)+491654216666515e-26*Math.sin(8*a)-726313725279022e-29*Math.sin(10*a)+107400991193683e-31*Math.sin(12*a));M=M=p*(1-Math.pow(m,2))*(1.00505250559297*a-.00253155620900066*Math.sin(2*a)+265690155540381e-20*Math.sin(4*a));var c=M+o*r*Math.pow(Math.cos(a),2)*h*(.5+(5-r*r+9*l+4*Math.pow(l,2))*Math.pow(Math.cos(a),2)*h/24+(61-58*r*r+Math.pow(r,4))/720*Math.pow(Math.cos(a),4)*Math.pow(h,2));c=M+o*Math.sin(a)*Math.cos(a)*h*(.5+(5-r*r+9*l+4*Math.pow(l,2))*Math.pow(Math.cos(a),2)*h/24+(61-58*r*r+Math.pow(r,4))/720*Math.pow(Math.cos(a),4)*Math.pow(h,2));var _=o*Math.cos(a)*u*(1+(1-r*r+l)*Math.pow(Math.cos(a),2)*h/6+(5-18*r*r+Math.pow(r,4)+14*l-58*l*r*r)*Math.pow(Math.cos(a),4)*Math.pow(h,2)/120);return _=_+5e5,{X:_,Y:c}},G2000BLtoGZ2000XYZ:function(a,i,t,e){var p=f.GaussTransform.BL2XY(a,i,t,e);return f.GaussTransform.G2000XYtoGZ2000XYZ(p.X,p.Y,t,e)},G2000XYtoGZ2000XYZ:function(a,i,t,e){var p={X:a-460020,Y:i-2329620};return f.GaussTransform.G2000XYtoGZ2000XYZTransformPoint(p)},G2000XYtoGZ2000XYZTransformPoint:function(a){var i={X:a.Y,Y:a.X},t=f.GaussTransform.fourTransPra.scale,e=f.GaussTransform.fourTransPra.rotationAngle*Math.PI/180,p=f.GaussTransform.fourTransPra.DX,d=f.GaussTransform.fourTransPra.DY,w=t*Math.cos(e),v=t*Math.sin(e),n=w*i.X-v*i.Y+p,m=w*i.Y+v*i.X+d;return{X:m,Y:n+2e5}},GZ2000XYtoG2000XYZTransformPoint:function(a,i){var t={X:a,Y:i},e={Y:t.X,X:t.Y-2e5},p=f.GaussTransform.fourTransPra.scale,d=f.GaussTransform.fourTransPra.rotationAngle*Math.PI/180,w=f.GaussTransform.fourTransPra.DX,v=f.GaussTransform.fourTransPra.DY,n=p*Math.cos(d),m=p*Math.sin(d);return a=(n*e.X+m*e.Y-n*w-m*v)/(Math.pow(n,2)+Math.pow(m,2)),i=(n*e.Y-m*e.X+m*w-n*v)/(Math.pow(n,2)+Math.pow(m,2)),{X:i,Y:a}},GZ2000XYtoG2000XYZ:function(a,i,t,e){var p=f.GaussTransform.GZ2000XYtoG2000XYZTransformPoint(a,i);return{X:p.X+460020,Y:p.Y+2329620}},GZ2000XYtoG2000BL:function(a,i,t,e){var p=f.GaussTransform.GZ2000XYtoG2000XYZ(a,i,t,e);return f.GaussTransform.XY2BL(p.X,p.Y,t,e)},XY2BL:function(a,i,t,e){var p=i,d=a,t=t||f.GaussTransform.ellip_CGCS200,e=e||f.GaussTransform.ProjectionPara,w=t.a?t.a:0;t.b&&t.b;var v=t.f?t.f:0,n=Math.sqrt(2*v-Math.pow(v,2)),m=n/Math.sqrt(1-n*n),T=1+.75*Math.pow(n,2)+45/64*Math.pow(n,4)+175/256*Math.pow(n,6)+11025/16384*Math.pow(n,8)+43659/65536*Math.pow(n,10)+693693/1048576*Math.pow(n,12),l=3/8*Math.pow(n,2)+15/32*Math.pow(n,4)+525/1024*Math.pow(n,6)+2205/4096*Math.pow(n,8)+72765/131072*Math.pow(n,10)+297297/524288*Math.pow(n,12),r=15/256*Math.pow(n,4)+105/1024*Math.pow(n,6)+2205/16384*Math.pow(n,8)+10395/65536*Math.pow(n,10)+1486485/8388608*Math.pow(n,12),s=35/3072*Math.pow(n,6)+105/4096*Math.pow(n,8)+10395/262144*Math.pow(n,10)+55055/1048576*Math.pow(n,12),o=w*(1-Math.pow(n,2))*T*Math.PI/180,u=w*(1-Math.pow(n,2))*l,h=w*(1-Math.pow(n,2))*r,M=w*(1-Math.pow(n,2))*s,c=p/o,_=0;do if(_=c,c=c*Math.PI/180,c=(p-(-u*Math.sin(2*c)+h*Math.sin(4*c)-M*Math.sin(6*c)))/o,Math.abs(c-_)<1e-7)break;while(!0);c=c*Math.PI/180;var X=Math.pow(m,2)*Math.pow(Math.cos(c),2),g=Math.tan(c),b=Math.sqrt(1-Math.pow(n*Math.sin(c),2)),y=w*(1-Math.pow(n,2))/Math.pow(b,3),C=w/b;d=d%1e6-5e5;var G=d/C,Y=e.ZoneWide?e.ZoneWide:3,S=e.ZoneNo?e.ZoneNo:parseInt(x/Y)+1,L=e.CenterL?e.CenterL:S*Y-Y/2,D=f.AngleTransform.Degree2Radian(L,!1),R=D+(G-(1+2*g*g+X)*Math.pow(G,3)/6+(5+28*g*g+24*Math.pow(g,4)+6*X+8*X*Math.pow(g,2))*Math.pow(G,5)/120)/Math.cos(c),x=Math.round(f.AngleTransform.Radian2Degree(R,!1)*1e11)/1e11,j=c-g/(2*y)*d*G*(1-(5+3*g*g+X-9*X*Math.pow(g,2))*Math.pow(G,2)/12+(61+90*g*g+45*Math.pow(g,4))*Math.pow(G,4)/360),I=Math.round(f.AngleTransform.Radian2Degree(j,!1)*1e11)/1e11;return{B:I,L:x}},gcj02toG2000:function(a,i){var t=Math,e=Math.PI,p=function(h,M){let c;return c=-100+2*h+3*M+.2*M*M+.1*h*M+.2*Math.sqrt(Math.abs(h)),c+=(20*Math.sin(6*h*e)+20*Math.sin(2*h*e))*2/3,c+=(20*Math.sin(M*e)+40*Math.sin(M/3*e))*2/3,c+=(160*Math.sin(M/12*e)+320*Math.sin(M*e/30))*2/3,c},d=function(h,M){let c;return c=300+h+2*M+.1*h*h+.1*h*M+.1*t.sqrt(t.abs(h)),c+=(20*t.sin(6*h*e)+20*t.sin(2*h*e))*2/3,c+=(20*t.sin(h*e)+40*t.sin(h/3*e))*2/3,c+=(150*t.sin(h/12*e)+300*t.sin(h/30*e))*2/3,c},w=f.GaussTransform.ellip_CGCS200,v=w.a,n=w.f*2,m,T,l,r,s,o,u;return m=p(a-105,i-35),T=d(a-105,i-35),l=i/180*e,r=t.sin(l),r=1-n*r*r,u=t.sqrt(r),m=m*180/(v*(1-n)/(r*u)*e),T=T*180/(v/u*t.cos(l)*e),s=i+m,o=a+T,[a*2-o,i*2-s]},bd09togcj02:function(a,i){var t=3.141592653589793*3e3/180,a=+a,i=+i,e=a-.0065,p=i-.006,d=Math.sqrt(e*e+p*p)-2e-5*Math.sin(p*t),w=Math.atan2(p,e)-3e-6*Math.cos(e*t),v=d*Math.cos(w),n=d*Math.sin(w);return[v,n]}};f.AngleTransform={Degree2Radian:function(a,i){i&&(a=Ang60ToAng100(a));var t=a*Math.PI/180;return t},Ang60ToAng100:function(a){return Ang2Ms(a),Math.round()},Radian2Degree:function(a,i){var t;return t=a*180/Math.PI,i==!0&&(t=Ang100ToAng60(t)),t}};const ce={setup(a){ee.assetsPath="./assets";const i=W(null);let t=q([]),e;E(()=>{l()}),z(()=>{});function p(){const r=new ae({baseLayers:[new ie({url:"http://10.194.150.155:8010/ServiceAccess/MapService-T/2017\u5E74\u536B\u661F\u5F71\u50CF\u5730\u56FE_\u5E7F\u5DDE2000\u5750\u6807\u7CFB_/19f3612a2b44e98baae1f40713a085b6",title:"Basemap"})]}),s=new te({basemap:r});let o=new re({container:i.value,map:s,zoom:9.8,environment:{background:{type:"color",color:[216,214,209,.3]},starsEnabled:!1,atmosphereEnabled:!0}});o.when(u=>{let h=u.extent.center;h.x=43698.65155595513,h.y=228054.33760938543,u.goTo({center:h,tilt:0,zoom:16})}),o.ui.remove(["attribution","zoom"]),o.ui.empty("top-left"),window.view=o,s.ground.opacity=.2,s.ground.navigationConstraint={type:"none"},new he({id:"sceneLayer",url:"http://10.194.171.3/server/rest/services/eslpk/XFWWSGX20211215/SceneServer"}),w()}let d={view:window.view,scene:null,camera:null,renderer:null,setup:function(r){this.renderer=new U({context:r.gl,premultipliedAlpha:!1}),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setViewport(0,0,window.view.width,window.view.height),this.renderer.autoClearDepth=!1,this.renderer.autoClearStencil=!1,this.renderer.autoClearColor=!1,this.renderer.shadowMap.enabled=!1,this.scene=new F,this.camera=new O;const s=new V(16777215),o=new H(16777215,.6);o.position.x=2,o.position.y=3,o.position.z=4,o.castShadow=!1,this.scene.add(s),this.scene.add(o),this.scene.userData.viewResolution=window.view.resolution,n()},render:function(r){const s=r.camera;this.camera.position.set(s.eye[0],s.eye[1],s.eye[2]),this.camera.up.set(s.up[0],s.up[1],s.up[2]),this.camera.lookAt(new P(s.center[0],s.center[1],s.center[2])),this.camera.projectionMatrix.fromArray(s.projectionMatrix),e.offset.x+=-.005,e.needsUpdate=!0,this.renderer.render(this.scene,this.camera);const o={width:window.innerWidth,height:window.innerHeight};window.addEventListener("resize",()=>{o.width=window.innerWidth,o.height=window.innerHeight,this.camera.aspect=o.width/o.height,this.camera.updateProjectionMatrix(),this.renderer.setSize(o.width,o.height),this.renderer.setPixelRatio(Math.min(window.devicePixelRatio,2))}),this.renderer.state.reset(),r.bindRenderTarget(),this.renderer.render(this.scene,this.camera),oe(window.view),r.resetWebGLState()}};function w(){ne(window.view,d)}function v(r,s,o){let u=new Array(16);return se(window.view,[r,s,o],window.view.spatialReference,u),[u[12],u[13],u[14]]}function n(){const r={points:t,color:16755200,radius:1.5},s={points:t,texture:"images/allow_sewage.png",radius:1.5},{texture:o,mesh:u}=m(r),{texture:h,mesh:M}=m(s);return d.scene.add(u),d.scene.add(M),{tubeTexture0:o,tubeTexture1:h}}function m(r){const s=T(r.points),o=new K(s,3e3,r.radius,5,!1),u=new Q;let h;r.texture!==void 0?(e=u.load(r.texture),e.needsUpdate=!0,e.wrapS=A,e.wrapT=A,e.repeat.set(150,1),e.offset.y=.5,e.rotation=Math.PI,h=new Z({map:e,transparent:!0,side:$})):(h=new Z({color:r.color,transparent:!0,opacity:r.opacity}),h.depthWrite=!1);const M=new B(o,h);return M.receiveShadow=!1,M.castShadow=!1,{texture:e,mesh:M}}function T(r){let s=[];r.map(u=>s.push(v(...u)));let o=s.map(u=>new P(...u));return new J(o)}function l(){let r=[];return fetch("static/json/wsgsy0216.json").then(s=>s.json()).then(s=>{s.features=s.features.sort((o,u)=>u.attributes.sx-o.attributes.sx),s.features.map(o=>{r.push([o.geometry.x,o.geometry.y,-1.5])}),t=r}).then(()=>{p()}).catch(s=>{console.log(s.message)}),r}return(r,s)=>(N(),k("div",{id:"sceneContainer",ref:(o,u)=>{u.sceneContainer=o,i.value=o}},null,512))}};var ye=pe(ce,[["__scopeId","data-v-edec045e"]]);export{ye as default};
//# sourceMappingURL=gzPipe.61e2923b.js.map
