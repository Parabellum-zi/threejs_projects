{"version":3,"file":"portalLayers.33a2491a.js","sources":["../../node_modules/@arcgis/core/portal/support/portalItemUtils.js","../../node_modules/@arcgis/core/portal/support/portalLayers.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nfunction e(e,n){if(!t(e,n)){const t=e.typeKeywords;t?t.push(n):e.typeKeywords=[n]}}function t(e,t){return!!e.typeKeywords&&e.typeKeywords.indexOf(t)>-1}function n(e,t){const n=e.typeKeywords;if(n){const e=n.indexOf(t);e>-1&&n.splice(e,1)}}export{e as addTypeKeyword,t as hasTypeKeyword,n as removeTypeKeyword};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nimport e from\"../../core/Error.js\";import{layerLookupMap as r}from\"../../layers/support/lazyLayerLoader.js\";import t from\"../PortalItem.js\";import{getNumLayersAndTables as a,preprocessFSItemData as n,getFirstLayerOrTableId as o}from\"./layersLoader.js\";import{hasTypeKeyword as s}from\"./portalItemUtils.js\";import{requestArcGISServiceJSON as c}from\"../../support/requestPresets.js\";function u(e){return!e.portalItem||e.portalItem instanceof t||(e={...e,portalItem:new t(e.portalItem)}),l(e.portalItem).then((r=>{const t={portalItem:e.portalItem,...r.properties},a=r.constructor;return Promise.resolve(new a(t))}))}function l(e){return e.load().then(i).then(y)}function i(r){switch(r.type){case\"Map Service\":return m(r);case\"Feature Service\":return p(r);case\"Feature Collection\":return L(r);case\"Scene Service\":return f(r);case\"Image Service\":return d(r);case\"Stream Service\":return N();case\"Vector Tile Service\":return S();case\"KML\":return I();case\"WFS\":return h();case\"WMTS\":return v();case\"WMS\":return g();case\"Feed\":return w();default:return Promise.reject(new e(\"portal:unknown-item-type\",\"Unknown item type '${type}'\",{type:r.type}))}}function y(e){return(0,r[e.className])().then((r=>({constructor:r,properties:e.properties})))}function m(e){return T(e).then((e=>e?{className:\"TileLayer\"}:{className:\"MapImageLayer\"}))}function p(e){return M(e).then((e=>{if(\"object\"==typeof e){const r={};return null!=e.id&&(r.layerId=e.id),{className:\"FeatureLayer\",properties:r}}return{className:\"GroupLayer\"}}))}function f(e){return M(e).then((r=>{if(\"object\"==typeof r){const t={};let a;if(null!=r.id?(t.layerId=r.id,a=`${e.url}/layers/${r.id}`):a=e.url,Array.isArray(e.typeKeywords)&&e.typeKeywords.length>0){const r={IntegratedMesh:\"IntegratedMeshLayer\",\"3DObject\":\"SceneLayer\",Point:\"SceneLayer\",PointCloud:\"PointCloudLayer\",Building:\"BuildingSceneLayer\"};for(const t of Object.keys(r))if(-1!==e.typeKeywords.indexOf(t))return{className:r[t]}}return c(a).then((e=>{let r=\"SceneLayer\";const a={Point:\"SceneLayer\",\"3DObject\":\"SceneLayer\",IntegratedMesh:\"IntegratedMeshLayer\",PointCloud:\"PointCloudLayer\",Building:\"BuildingSceneLayer\"};return e&&e.layerType&&a[e.layerType]&&(r=a[e.layerType]),{className:r,properties:t}}))}return!1===r?c(e.url).then((e=>\"Voxel\"===(null==e?void 0:e.layerType)?{className:\"VoxelLayer\"}:{className:\"GroupLayer\"})):{className:\"GroupLayer\"}}))}async function L(e){await e.load();if(s(e,\"Map Notes\"))return{className:\"MapNotesLayer\"};if(s(e,\"Route Layer\"))return{className:\"RouteLayer\"};const r=await e.fetchData();return 1===a(r)?{className:\"FeatureLayer\"}:{className:\"GroupLayer\"}}async function d(e){var r,t,a;await e.load();const n=null!=(r=null==(t=e.typeKeywords)?void 0:t.map((e=>e.toLowerCase())))?r:[];if(n.indexOf(\"elevation 3d layer\")>-1)return{className:\"ElevationLayer\"};if(n.indexOf(\"tiled imagery\")>-1)return{className:\"ImageryTileLayer\"};const o=await e.fetchData(),s=null==o?void 0:o.layerType;if(\"ArcGISTiledImageServiceLayer\"===s)return{className:\"ImageryTileLayer\"};if(\"ArcGISImageServiceLayer\"===s)return{className:\"ImageryLayer\"};return\"map\"===(null==(a=(await c(e.url)).cacheType)?void 0:a.toLowerCase())?{className:\"ImageryTileLayer\"}:{className:\"ImageryLayer\"}}function N(){return{className:\"StreamLayer\"}}function S(){return{className:\"VectorTileLayer\"}}function I(){return{className:\"KMLLayer\"}}function h(){return{className:\"WFSLayer\"}}function g(){return{className:\"WMSLayer\"}}function v(){return{className:\"WMTSLayer\"}}function w(){return{className:\"StreamLayer\"}}function T(e){return c(e.url).then((e=>e.tileInfo))}function M(e){return!e.url||e.url.match(/\\/\\d+$/)?Promise.resolve({}):e.load().then((()=>e.fetchData())).then((async r=>{if(\"Feature Service\"===e.type)return j(r=await n(r,e.url));return a(r)>0?j(r):c(e.url).then(j)}))}function j(e){return 1===a(e)&&{id:o(e)}}export{u as fromItem,i as selectLayerClassPath};\n"],"names":["t","e","r","c","s","a","n","o"],"mappings":"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"}