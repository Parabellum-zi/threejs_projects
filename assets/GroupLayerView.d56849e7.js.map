{"version":3,"file":"GroupLayerView.d56849e7.js","sources":["../../node_modules/@arcgis/core/views/layers/GroupLayerView.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import i from\"../../core/Collection.js\";import{castForReferenceSetter as s,referenceSetter as r}from\"../../core/collectionUtils.js\";import{property as t}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/arrayUtils.js\";import\"../../core/has.js\";import\"../../core/accessorSupport/ensureType.js\";import{subclass as a}from\"../../core/accessorSupport/decorators/subclass.js\";import l from\"./LayerView.js\";let o=class extends l{constructor(e){super(e),this.type=\"group\",this.layerViews=new i}initialize(){this.handles.add([this.layerViews.on(\"change\",(e=>this._layerViewsChangeHandler(e))),this.layerViews.on(\"after-changes\",(()=>this._layerViewsAfterChangesHandler())),this.layer.watch(\"visibilityMode\",(()=>this._visibilityModeHandler()),!0),this.watch(\"visible\",(()=>this._visibleHandler()),!0)],\"grouplayerview\"),this._layerViewsChangeHandler({target:null,added:this.layerViews.toArray(),removed:[],moved:[]}),this._layerViewsAfterChangesHandler()}set layerViews(e){this._set(\"layerViews\",r(e,this._get(\"layerViews\")))}isUpdating(){return this.layerViews.some((e=>e.updating))}get updatingProgress(){return 0===this.layerViews.length?1:this.layerViews.reduce(((e,i)=>e+i.updatingProgress),0)/this.layerViews.length}_hasLayerViewVisibleOverrides(){return this.layerViews.some((e=>e._isOverridden(\"visible\")))}_findLayerViewForLayer(e){return e&&this.layerViews.find((i=>i.layer===e))}_firstVisibleOnLayerOrder(){const e=this.layer.layers.find((e=>{const i=this._findLayerViewForLayer(e);return i&&i.visible}));return e&&this._findLayerViewForLayer(e)}_enforceExclusiveVisibility(e){this._hasLayerViewVisibleOverrides()&&(e||!(e=this._firstVisibleOnLayerOrder())&&this.layerViews.length>0&&(e=this._findLayerViewForLayer(this.layer.layers.getItemAt(0))),this.layerViews.forEach((i=>{i.visible=i===e})))}_layerViewsChangeHandler(e){this.handles.remove(\"grouplayerview:visible\"),this.handles.add(this.layerViews.map((e=>e.watch(\"visible\",(i=>this._layerViewVisibleHandler(i,e)),!0))).toArray(),\"grouplayerview:visible\");const i=e.added[e.added.length-1];let s=null;i&&i.visible&&(s=i),this._enforceVisibility(s)}_layerViewsAfterChangesHandler(){this.handles.remove(\"grouplayerview:updating\"),this.handles.add(this.layerViews.map((e=>e.watch(\"updating\",(()=>this._updateUpdating()),!0))).toArray(),\"grouplayerview:updating\"),this._updateUpdating()}_enforceVisibility(e){if(this._hasLayerViewVisibleOverrides())switch(this.layer.visibilityMode){case\"inherited\":{const e=this.visible;this.layerViews.forEach((i=>{i.visible=e}));break}case\"exclusive\":this._enforceExclusiveVisibility(e)}}_visibilityModeHandler(){this._enforceVisibility()}_layerViewVisibleHandler(e,i){if(this._hasLayerViewVisibleOverrides())switch(this.layer.visibilityMode){case\"inherited\":e!==this.visible&&(i.visible=this.visible);break;case\"exclusive\":this._enforceExclusiveVisibility(e&&i)}}_visibleHandler(){var e;this._hasLayerViewVisibleOverrides()&&\"inherited\"===(null==(e=this.layer)?void 0:e.visibilityMode)&&this._enforceVisibility()}_updateUpdating(){this.notifyChange(\"updating\")}};e([t({cast:s})],o.prototype,\"layerViews\",null),e([t()],o.prototype,\"view\",void 0),e([t({readOnly:!0})],o.prototype,\"updatingProgress\",null),o=e([a(\"esri.views.layers.GroupLayerView\")],o);const h=o;export{h as default};\n"],"names":["l","i","r","t","s","a"],"mappings":"kGAIsd,GAAI,GAAE,aAAcA,EAAC,CAAC,YAAY,EAAE,CAAC,MAAM,GAAG,KAAK,KAAK,QAAQ,KAAK,WAAW,GAAIC,GAAE,YAAY,CAAC,KAAK,QAAQ,IAAI,CAAC,KAAK,WAAW,GAAG,SAAU,GAAG,KAAK,yBAAyB,IAAK,KAAK,WAAW,GAAG,gBAAiB,IAAI,KAAK,kCAAmC,KAAK,MAAM,MAAM,iBAAkB,IAAI,KAAK,yBAA0B,IAAI,KAAK,MAAM,UAAW,IAAI,KAAK,kBAAmB,KAAK,kBAAkB,KAAK,yBAAyB,CAAC,OAAO,KAAK,MAAM,KAAK,WAAW,UAAU,QAAQ,GAAG,MAAM,KAAK,KAAK,oCAAqC,YAAW,EAAE,CAAC,KAAK,KAAK,aAAaC,EAAE,EAAE,KAAK,KAAK,gBAAgB,YAAY,CAAC,MAAO,MAAK,WAAW,KAAM,GAAG,EAAE,aAAe,mBAAkB,CAAC,MAAO,AAAI,MAAK,WAAW,SAApB,EAA2B,EAAE,KAAK,WAAW,OAAQ,CAAC,EAAE,IAAI,EAAE,EAAE,iBAAkB,GAAG,KAAK,WAAW,OAAO,+BAA+B,CAAC,MAAO,MAAK,WAAW,KAAM,GAAG,EAAE,cAAc,YAAa,uBAAuB,EAAE,CAAC,MAAO,IAAG,KAAK,WAAW,KAAM,GAAG,EAAE,QAAQ,GAAI,2BAA2B,CAAC,KAAM,GAAE,KAAK,MAAM,OAAO,KAAM,GAAG,CAAC,KAAM,GAAE,KAAK,uBAAuB,GAAG,MAAO,IAAG,EAAE,UAAW,MAAO,IAAG,KAAK,uBAAuB,GAAG,4BAA4B,EAAE,CAAC,KAAK,iCAAkC,IAAG,CAAE,GAAE,KAAK,8BAA8B,KAAK,WAAW,OAAO,GAAI,GAAE,KAAK,uBAAuB,KAAK,MAAM,OAAO,UAAU,KAAK,KAAK,WAAW,QAAS,GAAG,CAAC,EAAE,QAAQ,IAAI,KAAM,yBAAyB,EAAE,CAAC,KAAK,QAAQ,OAAO,0BAA0B,KAAK,QAAQ,IAAI,KAAK,WAAW,IAAK,GAAG,EAAE,MAAM,UAAW,GAAG,KAAK,yBAAyB,EAAE,GAAI,KAAM,UAAU,0BAA0B,KAAM,GAAE,EAAE,MAAM,EAAE,MAAM,OAAO,GAAG,GAAI,GAAE,KAAK,GAAG,EAAE,SAAU,GAAE,GAAG,KAAK,mBAAmB,GAAG,gCAAgC,CAAC,KAAK,QAAQ,OAAO,2BAA2B,KAAK,QAAQ,IAAI,KAAK,WAAW,IAAK,GAAG,EAAE,MAAM,WAAY,IAAI,KAAK,kBAAmB,KAAM,UAAU,2BAA2B,KAAK,kBAAkB,mBAAmB,EAAE,CAAC,GAAG,KAAK,gCAAgC,OAAO,KAAK,MAAM,oBAAoB,YAAY,CAAC,KAAM,GAAE,KAAK,QAAQ,KAAK,WAAW,QAAS,GAAG,CAAC,EAAE,QAAQ,IAAK,UAAU,YAAY,KAAK,4BAA4B,IAAI,wBAAwB,CAAC,KAAK,qBAAqB,yBAAyB,EAAE,EAAE,CAAC,GAAG,KAAK,gCAAgC,OAAO,KAAK,MAAM,oBAAoB,YAAY,IAAI,KAAK,SAAU,GAAE,QAAQ,KAAK,SAAS,UAAU,YAAY,KAAK,4BAA4B,GAAG,IAAI,iBAAiB,CAAC,GAAI,GAAE,KAAK,iCAAiC,AAAe,CAAO,GAAE,KAAK,QAAd,KAAqB,OAAO,EAAE,kBAA7C,aAA8D,KAAK,qBAAqB,iBAAiB,CAAC,KAAK,aAAa,cAAc,EAAE,CAACC,EAAE,CAAC,KAAKC,KAAK,EAAE,UAAU,aAAa,MAAM,EAAE,CAACD,KAAK,EAAE,UAAU,OAAO,QAAQ,EAAE,CAACA,EAAE,CAAC,SAAS,MAAM,EAAE,UAAU,mBAAmB,MAAM,EAAE,EAAE,CAACE,EAAE,qCAAqC,GAAQ,KAAC,GAAE"}