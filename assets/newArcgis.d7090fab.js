import{ref as T,reactive as j,onMounted as L,openBlock as k,createElementBlock as W}from"vue";import{W as z,S as D,P as E,aD as H,a as B,A as G,V as x,m as V,n as I,T as U,R as g,M as X,D as Y,o as q,c as F}from"./three.module.3b505d30.js";import{r as J,j as K,s as N,a as O,b as Q,y as Z,u as $}from"./externalRenderers.e9b2a64d.js";import{S as ee,R as te}from"./stats.module.0fc722e3.js";import{_ as re}from"./index.f0707c98.js";import"./vendor.c70270c6.js";const ne={setup(ie){J.assetsPath="./assets";const p=T(null),u=[[115.80895340787583,30.92933111293343,20],[115.81947621477968,30.936026430486265,20],[115.85073577332635,30.952730603143078,20],[115.86830705038578,30.964969701156637,20],[115.87796494895557,30.970050440481813,20],[115.88263291871093,30.97587476869184,20],[115.88153549018487,30.97619308639916,20],[115.88860467181571,30.985581605596618,20],[115.89039457558401,30.99614115304192,20],[115.89037581420371,30.99986573852132,20],[115.88982453627196,31.003621647335926,20],[115.88822886767906,30.999078415194415,20],[115.88681216877917,30.997464365151867,20],[115.88286139825868,30.99686255666582,20],[115.87841763117079,30.999826971071514,20],[115.86308179931808,30.99584156461405,20],[115.85510630972263,30.993171784031908,20],[115.86174910808289,30.993473404196706,20],[115.86231959908358,30.99068362090549,20]];let i,c,w,h;const l=new te,a=l.track.bind(l);let s=j({}),d;L(()=>{y(),b(),C()});function y(){const n=new K({basemap:"satellite"});let t=new N({container:p.value,map:n,environment:{background:{type:"color",color:[216,214,209,.3]},starsEnabled:!1,atmosphereEnabled:!0},camera:{position:[115.87107,30.9969,1315],tilt:1}});t.ui.remove(["attribution","zoom"]),t.ui.empty("top-left"),window.view=t,n.ground.opacity=.5}function b(){d=new ee,d.showPanel(0),document.body.appendChild(d.dom)}class _{constructor(t){this.view=t,this.scene=null,this.camera=null,this.renderer=null}setup(t){this.renderer=new z({context:t.gl,premultipliedAlpha:!1}),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setViewport(0,0,window.view.width,window.view.height),this.renderer.autoClearDepth=!1,this.renderer.autoClearStencil=!1,this.renderer.autoClearColor=!1,this.scene=new D,this.camera=new E;const r=new H(9474192),e=new B(16777215,.6);e.position.x=2,e.position.y=3,e.position.z=4,this.scene.add(r),this.scene.add(e);const o=new G(5e6);this.scene.add(o),this.scene.userData.viewResolution=window.view.resolution,M(this.scene)}render(t){const r=t.camera;this.camera.position.set(r.eye[0],r.eye[1],r.eye[2]),this.camera.up.set(r.up[0],r.up[1],r.up[2]),this.camera.lookAt(new x(r.center[0],r.center[1],r.center[2])),this.camera.projectionMatrix.fromArray(r.projectionMatrix),i&&(i.offset.x+=-.005,i.needsUpdate=!0),d.update(),this.renderer.render(this.scene,this.camera);const e={width:window.innerWidth,height:window.innerHeight};window.addEventListener("resize",()=>{e.width=window.innerWidth,e.height=window.innerHeight,this.camera.aspect=e.width/e.height,this.camera.updateProjectionMatrix(),this.renderer.setSize(e.width,e.height),this.renderer.setPixelRatio(Math.min(window.devicePixelRatio,2))}),this.renderer.state.reset(),t.bindRenderTarget(),this.renderer.render(this.scene,this.camera),Q(window.view),t.resetWebGLState()}}function R(){console.log(s),s=null,s=new _(window.view),O(window.view,s)}function P(n,t,r){let e=new Array(16),o=Z(n,t);return $(window.view,[o[0],o[1],r],window.view.spatialReference,e),[e[12],e[13],e[14]]}function M(){const n={points:u,color:4491519,radius:1.5,opacity:.1},t={points:u,texture:"images/allow2.png",radius:3},{texture:r,mesh:e}=m(n),{texture:o,mesh:S}=m(t);return console.log(s),s.scene.add(a(e)),s.scene.add(a(S)),{tubeTexture1:o}}function m(n){const t=A(n.points);h=a(new I(t,100,n.radius,20,!1));const r=new U;return n.texture!==void 0?(i=r.load(n.texture,()=>{}),i.wrapS=g,i.wrapT=g,i.repeat.set(300,1),i.offset.y=.15,c=a(new X({map:i,transparent:!0,side:Y}))):(c=a(new q({color:n.color,transparent:!0,opacity:n.opacity})),c.depthWrite=!1),w=a(new F(h,c)),{texture:i,mesh:w}}function A(n){let t=[];n.map(e=>t.push(P(...e)));let r=t.map(e=>new x(...e));return new V(r)}function f(n=0){return new Promise(t=>setTimeout(t,n*1e3))}let v=0;async function C(){for(;;)v++,R(),await f(3),l.dispose(),console.log(s.renderer.info.memory),await f(1),console.log(v)}return(n,t)=>(k(),W("div",{id:"sceneContainer",ref:(r,e)=>{e.sceneContainer=r,p.value=r}},null,512))}};var pe=re(ne,[["__scopeId","data-v-5d7991af"]]);export{pe as default};
//# sourceMappingURL=newArcgis.d7090fab.js.map
